(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{Di0D:function(t,e,i){},hl0Z:function(t,e){},jUrH:function(t,e,i){"use strict";i.r(e),i.d(e,"spreadsheet",(function(){return nr}));var n=i("ODXe"),r=i("VTBJ"),a=i("1OyB"),l=i("vuIU"),s=i("T5bk"),c=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(a["default"])(this,t),"string"===typeof e?(this.el=document.createElement(e),this.el.className=i):this.el=e,this.data={}}return Object(l["default"])(t,[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var i=t.split("."),n=Object(s["a"])(i),r=n[0],a=n.slice(1),l=r;return"mousewheel"===l&&/Firefox/i.test(window.navigator.userAgent)&&(l="DOMMouseScroll"),this.el.addEventListener(l,(function(t){e(t);for(var i=0;i<a.length;i+=1){var n=a[i];if("left"===n&&0!==t.button)return;if("right"===n&&2!==t.button)return;"stop"===n&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(i){e.css(i,"".concat(t[i],"px"))})),this;var i=this.el,n=i.offsetTop,r=i.offsetLeft,a=i.offsetHeight,l=i.offsetWidth;return{top:n,left:r,height:a,width:l}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(i.forEach((function(e){return t.child(e)})),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var i=e;return"string"===typeof e?i=document.createTextNode(e):e instanceof t&&(i=e.el),this.el.appendChild(i),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var i=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"===typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){i.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var i=this;return void 0===e&&"string"!==typeof t?(Object.keys(t).forEach((function(e){i.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}]),t}(),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new c(t,e)},h=i("KQm4"),u=(i("hl0Z"),["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]);function f(t){var e="",i=t;while(i>=u.length)i/=u.length,i-=1,e+=u[parseInt(i,10)%u.length];var n=t%u.length;return e+=u[n],e}function d(t){for(var e=0,i=0;i<t.length-1;i+=1){var n=t.charCodeAt(i)-65,r=t.length-1-i;e+=Math.pow(u.length,r)+u.length*n}return e+=t.charCodeAt(t.length-1)-65,e}function v(t){for(var e="",i="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?i+=t.charAt(n):e+=t.charAt(n);return[d(e),parseInt(i,10)-1]}function g(t,e){return"".concat(f(t)).concat(e+1)}function p(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===i)return t;var a=v(t),l=Object(n["a"])(a,2),s=l[0],c=l[1];return r(s,c)?g(s+e,c+i):t}var y=function(){function t(e,i,n,r){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;Object(a["default"])(this,t),this.sri=e,this.sci=i,this.eri=n,this.eci=r,this.w=l,this.h=s}return Object(l["default"])(t,[{key:"set",value:function(t,e,i,n){this.sri=t,this.sci=e,this.eri=i,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];if(1===r.length){var l=v(r[0]),s=Object(n["a"])(l,2);e=s[0],t=s[1]}else 2===r.length&&(t=r[0],e=r[1]);var c=this.sri,o=this.sci,h=this.eri,u=this.eci;return c<=t&&t<=h&&o<=e&&e<=u}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},i=this.sri,n=this.sci,r=this.eri,a=this.eci,l=i;l<=r;l+=1)if(e(l))for(var s=n;s<=a;s+=1)t(l,s)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var i=this.sri,n=this.sci,r=this.eri,a=this.eci;return new t(e.sri<i?e.sri:i,e.sci<n?e.sci:n,e.eri>r?e.eri:r,e.eci>a?e.eci:a)}},{key:"difference",value:function(e){var i=[],n=function(e,n,r,a){i.push(new t(e,n,r,a))},r=this.sri,a=this.sci,l=this.eri,s=this.eci,c=e.sri-r,o=e.sci-a,h=l-e.eri,u=s-e.eci;return c>0?(n(r,a,e.sri-1,s),h>0?(n(e.eri+1,a,l,s),o>0&&n(e.sri,a,e.eri,e.sci-1),u>0&&n(e.sri,e.eci+1,e.eri,s)):(o>0&&n(e.sri,a,l,e.sci-1),u>0&&n(e.sri,e.eci+1,l,s))):h>0&&(n(e.eri+1,a,l,s),o>0&&n(r,a,e.eri,e.sci-1),u>0&&n(r,e.eci+1,e.eri,s)),o>0?(n(r,a,l,e.sci-1),u>0?(n(r,e.eri+1,l,s),c>0&&n(r,e.sci,e.sri-1,e.eci),h>0&&n(e.sri+1,e.sci,l,e.eci)):(c>0&&n(r,e.sci,e.sri-1,s),h>0&&n(e.sri+1,e.sci,l,s))):u>0&&(n(l,e.eci+1,l,s),c>0&&n(r,a,e.sri-1,e.eci),h>0&&n(e.eri+1,a,l,e.eci)),i}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,i=this.eri,n=this.eci,r=g(e,t);return this.multiple()&&(r="".concat(r,":").concat(g(n,i))),r}},{key:"clone",value:function(){var e=this.sri,i=this.sci,n=this.eri,r=this.eci,a=this.w,l=this.h;return new t(e,i,n,r,a,l)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}],[{key:"valueOf",value:function(e){var i=e.split(":"),r=v(i[0]),a=Object(n["a"])(r,2),l=a[0],s=a[1],c=s,o=l;if(i.length>1){var h=v(i[1]),u=Object(n["a"])(h,2);o=u[0],c=u[1]}return new t(s,l,c,o)}}]),t}(),b=function(){function t(){Object(a["default"])(this,t),this.range=new y(0,0,0,0),this.ri=0,this.ci=0}return Object(l["default"])(t,[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}]),t}(),m=function t(){Object(a["default"])(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0},w=function(){function t(){Object(a["default"])(this,t),this.undoItems=[],this.redoItems=[]}return Object(l["default"])(t,[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var i=this.undoItems,n=this.redoItems;this.canUndo()&&(n.push(JSON.stringify(t)),e(JSON.parse(i.pop())))}},{key:"redo",value:function(t,e){var i=this.undoItems,n=this.redoItems;this.canRedo()&&(i.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}}]),t}(),k=function(){function t(){Object(a["default"])(this,t),this.range=null,this.state="clear"}return Object(l["default"])(t,[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}]),t}(),O=function(){function t(e,i,n){Object(a["default"])(this,t),this.ci=e,this.operator=i,this.value=n}return Object(l["default"])(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,i=this.value;return"all"===e||"in"===e&&i.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){var t=this.ci,e=this.operator,i=this.value;return{ci:t,operator:e,value:i}}}]),t}(),x=function(){function t(e,i){Object(a["default"])(this,t),this.ci=e,this.order=i}return Object(l["default"])(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),j=function(){function t(){Object(a["default"])(this,t),this.ref=null,this.filters=[],this.sort=null}return Object(l["default"])(t,[{key:"setData",value:function(t){var e=t.ref,i=t.filters,n=t.sort;null!=e&&(this.ref=e,this.filters=i.map((function(t){return new O(t.ci,t.operator,t.value)})),n&&(this.sort=new x(n.ci,n.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,i=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:i}}return{}}},{key:"addFilter",value:function(t,e,i){var n=this.getFilter(t);null==n?this.filters.push(new O(t,e,i)):n.set(e,i)}},{key:"setSort",value:function(t,e){this.sort=e?new x(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,i=0;i<e.length;i+=1)if(e[i].ci===t)return e[i];return null}},{key:"filteredRows",value:function(t){var e=new Set,i=new Set;if(this.active())for(var n=this.range(),r=n.sri,a=n.eri,l=this.filters,s=r+1;s<=a;s+=1)for(var c=0;c<l.length;c+=1){var o=l[c],h=t(s,o.ci),u=h?h.text:"";if(!o.includes(u)){e.add(s);break}i.add(s)}return{rset:e,fset:i}}},{key:"items",value:function(t,e){var i={};if(this.active())for(var n=this.range(),r=n.sri,a=n.eri,l=r+1;l<=a;l+=1){var s=e(l,t);if(null===s||/^\s*$/.test(s.text))i[""]=(i[""]||0)+1;else{var c=s.text,o=(i[c]||0)+1;i[c]=o}}return i}},{key:"range",value:function(){return y.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}(),C=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(a["default"])(this,t),this._=e}return Object(l["default"])(t,[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var i=0;i<this._.length;i+=1){var n=this._[i];if(n.includes(t,e))return n}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1){var i=this._[e];if(i.intersects(t))return!0}return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,i,n){this._.forEach((function(r){var a=r.sri,l=r.sci,s=r.eri,c=r.eci,o=r;"row"===t?a>=e?(o.sri+=i,o.eri+=i):a<e&&e<=s&&(o.eri+=i,n(a,l,i,0)):"column"===t&&(l>=e?(o.sci+=i,o.eci+=i):l<e&&e<=c&&(o.eci+=i,n(a,l,0,i)))}))}},{key:"move",value:function(t,e,i){this._.forEach((function(n){var r=n;r.within(t)&&(r.eri+=e,r.sri+=e,r.sci+=i,r.eci+=i)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return y.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}]),t}();function E(t){return JSON.parse(JSON.stringify(t))}var S=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return n.forEach((function(i){Object.keys(i).forEach((function(n){var r=i[n];"string"===typeof r||"number"===typeof r||"boolean"===typeof r?e[n]=r:"function"!==typeof r&&!Array.isArray(r)&&r instanceof Object?(e[n]=e[n]||{},t(e[n],r)):e[n]=r}))})),e};function D(t,e){var i=Object.keys(t);if(i.length!==Object.keys(e).length)return!1;for(var n=0;n<i.length;n+=1){var r=i[n],a=t[r],l=e[r];if(void 0===l)return!1;if("string"===typeof a||"number"===typeof a||"boolean"===typeof a){if(a!==l)return!1}else if(Array.isArray(a)){if(a.length!==l.length)return!1;for(var s=0;s<a.length;s+=1)if(!D(a[s],l[s]))return!1}else if("function"!==typeof a&&!Array.isArray(a)&&a instanceof Object&&!D(a,l))return!1}return!0}var T=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},i=0,n=0;return Object.keys(t).forEach((function(r){i+=e(t[r],r),n+=1})),[i,n]};function A(t,e){var i=t["".concat(e)];return delete t["".concat(e)],i}function R(t,e,i,n,r,a){for(var l=i,s=n,c=t;c<e;c+=1){if(l>r)break;s=a(c),l+=s}return[c,l-s,s]}function z(t,e,i){for(var n=0,r=t;r<e;r+=1)n+=i(r);return n}function I(t,e,i){for(var n=t;n<e;n+=1)i(n)}function H(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i+=1)if(t[i]!==e[i])return!1;return!0}function M(t){for(var e="".concat(t),i=0,n=!1,r=0;r<e.length;r+=1)!0===n&&(i+=1),"."===e.charAt(r)&&(n=!0);return i}function N(t,e,i){if(Number.isNaN(e)||Number.isNaN(i))return e+t+i;var n=M(e),r=M(i),a=Number(e),l=Number(i),s=0;if("-"===t)s=a-l;else if("+"===t)s=a+l;else if("*"===t)s=a*l;else if("/"===t)return s=a/l,M(s)>5?s.toFixed(2):s;return s.toFixed(Math.max(n,r))}var F={cloneDeep:E,merge:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return S.apply(void 0,[{}].concat(e))},equals:D,arrayEquals:H,sum:T,rangeEach:I,rangeSum:z,rangeReduceIf:R,deleteProperty:A,numberCalc:N},W=function(){function t(e){var i=e.len,n=e.height;Object(a["default"])(this,t),this._={},this.len=i,this.height=n}return Object(l["default"])(t,[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){var i=this.getOrNew(t);i.height=e}},{key:"unhide",value:function(t){var e=t;while(e>0){if(e-=1,!this.isHide(e))break;this.setHide(e,!1)}}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var i=this.getOrNew(t);!0===e?i.hide=!0:delete i.hide}},{key:"setStyle",value:function(t,e){var i=this.getOrNew(t);i.style=e}},{key:"sumHeight",value:function(t,e,i){var n=this;return F.rangeSum(t,e,(function(t){return i&&i.has(t)?0:n.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var i=this.get(t);return void 0!==i&&void 0!==i.cells&&void 0!==i.cells[e]?i.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var i=this.getCell(t,e);return i&&i.merge?i.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var i=this.getOrNew(t);return i.cells[e]=i.cells[e]||{},i.cells[e]}},{key:"setCell",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",r=this.getOrNew(t);"all"===n?r.cells[e]=i:"text"===n?(r.cells[e]=r.cells[e]||{},r.cells[e].text=i.text):"format"===n&&(r.cells[e]=r.cells[e]||{},r.cells[e].style=i.style,i.merge&&(r.cells[e].merge=i.merge))}},{key:"setCellText",value:function(t,e,i){var n=this.getCellOrNew(t,e);!1!==n.editable&&(n.text=i)}},{key:"copyPaste",value:function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},l=t.sri,s=t.sci,c=t.eri,o=t.eci,h=e.sri,u=e.sci,f=e.eri,d=e.eci,v=t.size(),g=Object(n["a"])(v,2),y=g[0],b=g[1],m=e.size(),w=Object(n["a"])(m,2),k=w[0],O=w[1],x=!0,j=0;(f<l||d<s)&&(x=!1,j=f<l?k:O);for(var C=l;C<=c;C+=1)if(this._[C])for(var E=s;E<=o;E+=1)if(this._[C].cells&&this._[C].cells[E])for(var S=h;S<=f;S+=y)for(var D=u;D<=d;D+=b){var T=S+(C-l),A=D+(E-s),R=F.cloneDeep(this._[C].cells[E]);r&&R&&R.text&&R.text.length>0&&function(){var t=R.text,e=D-u+(S-h)+2;if(x||(e-=j+1),"="===t[0])R.text=t.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){var i=0,n=0;return l===h?i=e-1:n=e-1,/^\d+$/.test(t)?t:p(t,i,n)}));else if(y<=1&&b>1&&(h>c||f<l)||b<=1&&y>1&&(u>o||d<s)||y<=1&&b<=1){var i=/[\\.\d]+$/.exec(t);if(null!==i){var n=Number(i[0])+e-1;R.text=t.substring(0,i.index)+n}}}(),this.setCell(T,A,R,i),a(T,A,R)}}},{key:"cutPaste",value:function(t,e){var i=this,n={};this.each((function(r){i.eachCells(r,(function(a){var l=parseInt(r,10),s=parseInt(a,10);t.includes(r,a)&&(l=e.sri+(l-t.sri),s=e.sci+(s-t.sci)),n[l]=n[l]||{cells:{}},n[l].cells[s]=i._[r].cells[a]}))})),this._=n}},{key:"paste",value:function(t,e){var i=this;if(!(t.length<=0)){var n=e.sri,r=e.sci;t.forEach((function(t,e){var a=n+e;t.forEach((function(t,e){var n=r+e;i.setCellText(a,n,t)}))}))}}},{key:"insert",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={};this.each((function(r,a){var l=parseInt(r,10);l>=t&&(l+=i,e.eachCells(r,(function(e,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return p(e,0,i,(function(e,i){return i>=t}))})))}))),n[l]=a})),this._=n,this.len+=i}},{key:"delete",value:function(t,e){var i=this,n=e-t+1,r={};this.each((function(a,l){var s=parseInt(a,10);s<t?r[s]=l:a>e&&(r[s-n]=l,i.eachCells(a,(function(t,i){i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return p(t,0,-n,(function(t,i){return i>e}))})))})))})),this._=r,this.len-=n}},{key:"insertColumn",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(n,r){var a={};e.eachCells(n,(function(e,n){var r=parseInt(e,10);r>=t&&(r+=i,n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return p(e,i,0,(function(e){return e>=t}))})))),a[r]=n})),r.cells=a}))}},{key:"deleteColumn",value:function(t,e){var i=this,n=e-t+1;this.each((function(r,a){var l={};i.eachCells(r,(function(i,r){var a=parseInt(i,10);a<t?l[a]=r:a>e&&(l[a-n]=r,r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return p(t,-n,0,(function(t){return t>e}))}))))})),a.cells=l}))}},{key:"deleteCells",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,n){e.deleteCell(t,n,i)}))}},{key:"deleteCell",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=this.get(t);if(null!==n){var r=this.getCell(t,e);null!==r&&!1!==r.editable&&("all"===i?delete n.cells[e]:"text"===i?(r.text&&delete r.text,r.value&&delete r.value):"format"===i?(void 0!==r.style&&delete r.style,r.merge&&delete r.merge):"merge"===i&&r.merge&&delete r.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],i=this._[e];if(i){var n=i.cells,r=Object.keys(n),a=r[r.length-1];return[parseInt(e,10),parseInt(a,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var i=Object(n["a"])(e,2),r=i[0],a=i[1];t(r,a)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var i=Object(n["a"])(t,2),r=i[0],a=i[1];e(r,a)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}]),t}(),V=function(){function t(e){var i=e.len,n=e.width,r=e.indexWidth,l=e.minWidth;Object(a["default"])(this,t),this._={},this.len=i,this.width=n,this.indexWidth=r,this.minWidth=l}return Object(l["default"])(t,[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){var i=this.getOrNew(t);i.width=e}},{key:"unhide",value:function(t){var e=t;while(e>0){if(e-=1,!this.isHide(e))break;this.setHide(e,!1)}}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var i=this.getOrNew(t);!0===e?i.hide=!0:delete i.hide}},{key:"setStyle",value:function(t,e){var i=this.getOrNew(t);i.style=e}},{key:"sumWidth",value:function(t,e){var i=this;return F.rangeSum(t,e,(function(t){return i.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}]),t}(),_=i("BsWD");function P(t,e){var i;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=Object(_["a"])(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return l=t.done,t},e:function(t){s=!0,a=t},f:function(){try{l||null==i["return"]||i["return"]()}finally{if(s)throw a}}}}var q={toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}},B=["en"],L={en:q};function U(t,e){if(e){var i,n=P(B);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(!e[r])break;for(var a=e[r],l=t.match(/(?:\\.|[^.])+/g),s=0;s<l.length;s+=1){var c=l[s],o=a[c];if(!o)break;if(s===l.length-1)return o;a=o}}}catch(h){n.e(h)}finally{n.f()}}}function Y(t){var e=U(t,L);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=U(t,window.x_spreadsheet.$messages)),e||""}function $(t){return function(){return Y(t)}}function X(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i?B=[t]:B.unshift(t),e&&(L[t]=e)}var J={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function K(t,e){var i="";if(!t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];i=Y.apply(void 0,["validation.".concat(e)].concat(r))}return[t,i]}var Z=function(){function t(e,i,n,r){Object(a["default"])(this,t),this.required=i,this.value=n,this.type=e,this.operator=r,this.message=""}return Object(l["default"])(t,[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?F.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,i=this.operator,r=this.value,a=this.type;if(e&&/^\s*$/.test(t))return K(!1,"required");if(/^\s*$/.test(t))return[!0];if(J[a]&&!J[a].test(t))return K(!1,"notMatch");if("list"===a)return K(this.values().includes(t),"notIn");if(i){var l=this.parseValue(t);if("be"===i){var s=Object(n["a"])(r,2),c=s[0],o=s[1];return K(l>=this.parseValue(c)&&l<=this.parseValue(o),"between",c,o)}if("nbe"===i){var h=Object(n["a"])(r,2),u=h[0],f=h[1];return K(l<this.parseValue(u)||l>this.parseValue(f),"notBetween",u,f)}if("eq"===i)return K(l===this.parseValue(r),"equal",r);if("neq"===i)return K(l!==this.parseValue(r),"notEqual",r);if("lt"===i)return K(l<this.parseValue(r),"lessThan",r);if("lte"===i)return K(l<=this.parseValue(r),"lessThanEqual",r);if("gt"===i)return K(l>this.parseValue(r),"greaterThan",r);if("gte"===i)return K(l>=this.parseValue(r),"greaterThanEqual",r)}return[!0]}}]),t}(),G=function(){function t(e,i,n){Object(a["default"])(this,t),this.refs=i,this.mode=e,this.validator=n}return Object(l["default"])(t,[{key:"includes",value:function(t,e){for(var i=this.refs,n=0;n<i.length;n+=1){var r=y.valueOf(i[n]);if(r.includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(y.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach((function(i){var n=y.valueOf(i);if(n.intersects(t)){var r=n.difference(t);r.forEach((function(t){return e.push(t.toString())}))}else e.push(i)})),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,i=this.validator,n=i.type,r=i.required,a=i.operator,l=i.value;return{refs:t,mode:e,type:n,required:r,operator:a,value:l}}}],[{key:"valueOf",value:function(e){var i=e.refs,n=e.mode,r=e.type,a=e.required,l=e.operator,s=e.value;return new t(n,i,new Z(r,a,s,l))}}]),t}(),Q=function(){function t(){Object(a["default"])(this,t),this._=[],this.errors=new Map}return Object(l["default"])(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,i){var r=this.get(t,e),a="".concat(t,"_").concat(e),l=this.errors;if(null!==r){var s=r.validator.validate(i),c=Object(n["a"])(s,2),o=c[0],h=c[1];o?l["delete"](a):l.set(a,h)}else l["delete"](a);return!0}},{key:"add",value:function(t,e,i){var n=i.type,r=i.required,a=i.value,l=i.operator,s=new Z(n,r,a,l),c=this.getByValidator(s);null!==c?c.addRef(e):this._.push(new G(t,[e],s))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var i=this._[e];if(i.validator.equals(t))return i}return null}},{key:"get",value:function(t,e){for(var i=0;i<this._.length;i+=1){var n=this._[i];if(n.includes(t,e))return n}return null}},{key:"remove",value:function(t){this.each((function(e){e.remove(t)}))}},{key:"each",value:function(t){this._.forEach((function(e){return t(e)}))}},{key:"getData",value:function(){return this._.filter((function(t){return t.refs.length>0})).map((function(t){return t.getData()}))}},{key:"setData",value:function(t){this._=t.map((function(t){return G.valueOf(t)}))}}]),t}(),tt={mode:"edit",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}},et=41,it=41,nt=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};function rt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.merges,a=e.clone(),l=t.size(),s=Object(n["a"])(l,2),c=s[0],o=s[1],h=e.size(),u=Object(n["a"])(h,2),f=u[0],d=u[1];return c>f&&(a.eri=e.sri+c-1),o>d&&(a.eci=e.sci+o-1),!r.intersects(a)||(i(Y("error.pasteForMergedCell")),!1)}function at(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.rows,l=this.merges;"all"!==i&&"format"!==i||(a.deleteCells(e,i),l.deleteWithin(e)),a.copyPaste(t,e,i,r,(function(t,e,i){if(i&&i.merge){var r=Object(n["a"])(i.merge,2),a=r[0],s=r[1];if(a<=0&&s<=0)return;l.add(new y(t,e,t+a,e+s))}}))}function lt(t,e){var i=this.clipboard,n=this.rows,r=this.merges;n.cutPaste(t,e),r.move(t,e.sri-t.sri,e.sci-t.sci),i.clear()}function st(t,e,i){var n=this.styles,r=this.rows,a=r.getCellOrNew(t,e),l={};void 0!==a.style&&(l=F.cloneDeep(n[a.style])),l=F.merge(l,{border:i}),a.style=this.addStyle(l)}function ct(t){var e=this,i=t.mode,r=t.style,a=t.color,l=this.styles,s=this.selector,c=this.rows,o=s.range,h=o.sri,u=o.sci,f=o.eri,d=o.eci,v=!this.isSignleSelected();if(v||"inside"!==i&&"horizontal"!==i&&"vertical"!==i)if("outside"!==i||v){if("none"===i)s.range.each((function(t,i){var n=c.getCell(t,i);if(n&&void 0!==n.style){var r=F.cloneDeep(l[n.style]);delete r.border,n.style=e.addStyle(r)}}));else if("all"===i||"inside"===i||"outside"===i||"horizontal"===i||"vertical"===i)(function(){for(var t=[],l=h;l<=f;l+=1)for(var s=u;s<=d;s+=1){for(var o=[],g=0;g<t.length;g+=1){var p=Object(n["a"])(t[g],4),y=p[0],b=p[1],m=p[2],w=p[3];if(l===y+m+1&&o.push(g),y<=l&&l<=y+m&&s===b){s+=w+1;break}}if(o.forEach((function(e){return t.splice(e,1)})),s>d)break;var k=c.getCell(l,s),O=0,x=0;if(k&&k.merge){var j=Object(n["a"])(k.merge,2);O=j[0],x=j[1],t.push([l,s,O,x])}var C=O>0&&l+O===f,E=x>0&&s+x===d,S={};"all"===i?S={bottom:[r,a],top:[r,a],left:[r,a],right:[r,a]}:"inside"===i?(!E&&s<d&&(S.right=[r,a]),!C&&l<f&&(S.bottom=[r,a])):"horizontal"===i?!C&&l<f&&(S.bottom=[r,a]):"vertical"===i?!E&&s<d&&(S.right=[r,a]):"outside"===i&&v&&(h===l&&(S.top=[r,a]),(C||f===l)&&(S.bottom=[r,a]),u===s&&(S.left=[r,a]),(E||d===s)&&(S.right=[r,a])),Object.keys(S).length>0&&st.call(e,l,s,S),s+=x}})();else if("top"===i||"bottom"===i)for(var g=u;g<=d;g+=1)"top"===i&&(st.call(this,h,g,{top:[r,a]}),g+=c.getCellMerge(h,g)[1]),"bottom"===i&&(st.call(this,f,g,{bottom:[r,a]}),g+=c.getCellMerge(f,g)[1]);else if("left"===i||"right"===i)for(var p=h;p<=f;p+=1)"left"===i&&(st.call(this,p,u,{left:[r,a]}),p+=c.getCellMerge(p,u)[0]),"right"===i&&(st.call(this,p,d,{right:[r,a]}),p+=c.getCellMerge(p,d)[0])}else st.call(this,h,u,{top:[r,a],bottom:[r,a],left:[r,a],right:[r,a]})}function ot(t,e){var i=this.rows,n=this.freezeTotalHeight(),r=i.height;n+i.height<t&&(r-=e);for(var a=this.exceptRowSet,l=0,s=r,c=i.height;l<i.len;l+=1){if(s>t)break;a.has(l)||(c=i.getHeight(l),s+=c)}return s-=c,s<=0?{ri:-1,top:0,height:c}:{ri:l-1,top:s,height:c}}function ht(t,e){var i=this.cols,r=this.freezeTotalWidth(),a=i.indexWidth;r+i.indexWidth<t&&(a-=e);var l=F.rangeReduceIf(0,i.len,a,i.indexWidth,t,(function(t){return i.getWidth(t)})),s=Object(n["a"])(l,3),c=s[0],o=s[1],h=s[2];return o<=0?{ci:-1,left:0,width:i.indexWidth}:{ci:c-1,left:o,width:h}}var ut=function(){function t(e,i){Object(a["default"])(this,t),this.settings=F.merge(tt,i||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new C,this.rows=new W(this.settings.row),this.cols=new V(this.settings.col),this.validations=new Q,this.hyperlinks={},this.comments={},this.selector=new b,this.scroll=new m,this.history=new w,this.clipboard=new k,this.autoFilter=new j,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}return Object(l["default"])(t,[{key:"addValidation",value:function(t,e,i){var n=this;this.changeData((function(){n.validations.add(t,e,i)}))}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData((function(){t.validations.remove(e)}))}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,i=t.ci,n=this.validations.get(e,i);return n?n.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,i=t.ci,n=t.range,r=this.validations.get(e,i),a={ref:n.toString()};return null!==r&&(a.mode=r.mode,a.validator=r.validator),a}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(){if(void 0!==navigator.clipboard){for(var t="",e=this.rows.getData(),i=this.selector.range.sri;i<=this.selector.range.eri;i+=1){if(nt(e,i)){for(var n=this.selector.range.sci;n<=this.selector.range.eci;n+=1)if(n>this.selector.range.sci&&(t+="\t"),nt(e[i].cells,n)){var r=String(e[i].cells[n].text);-1===r.indexOf("\n")&&-1===r.indexOf("\t")&&-1===r.indexOf('"')?t+=r:t+='"'.concat(r,'"')}}else for(var a=this.selector.range.sci;a<=this.selector.range.eci;a+=1)t+="\t";t+="\n"}navigator.clipboard.writeText(t).then((function(){}),(function(e){console.log("text copy to the system clipboard error  ",t,e)}))}}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.clipboard,r=this.selector;return!n.isClear()&&(!!rt.call(this,n.range,r.range,i)&&(this.changeData((function(){n.isCopy()?at.call(t,n.range,r.range,e):n.isCut()&&lt.call(t,n.range,r.range)})),!0))}},{key:"pasteFromText",value:function(t){var e=t.split("\r\n").map((function(t){return t.replace(/"/g,"").split("\t")}));e.length>0&&(e.length-=1);var i=this.rows,n=this.selector;this.changeData((function(){i.paste(e,n.range)}))}},{key:"autofill",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.selector.range;return!!rt.call(this,r,t,n)&&(this.changeData((function(){at.call(i,r,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var i=this.selector,n=this.rows,r=this.cols,a=this.merges,l=i.range,s=l.sri,c=l.sci,o=l.eri,h=l.eci,u=i.ri,f=i.ci,d=t,v=e;return t<0&&(d=n.len-1),e<0&&(v=r.len-1),d>u?(s=u,o=d):(s=d,o=u),v>f?(c=f,h=v):(c=v,h=f),i.range=a.union(new y(s,c,o,h)),i.range=a.union(i.range),i.range}},{key:"calSelectedRangeByStart",value:function(t,e){var i=this.selector,n=this.rows,r=this.cols,a=this.merges,l=a.getFirstIncludes(t,e);return null===l&&(l=new y(t,e,t,e),-1===t&&(l.sri=0,l.eri=n.len-1),-1===e&&(l.sci=0,l.eci=r.len-1)),i.range=l,l}},{key:"setSelectedCellAttr",value:function(t,e){var i=this;this.changeData((function(){var r=i.selector,a=i.styles,l=i.rows;if("merge"===t)e?i.merge():i.unmerge();else if("border"===t)ct.call(i,e);else if("formula"===t){var s=r.ri,c=r.ci,o=r.range;if(r.multiple()){var h=r.size(),u=Object(n["a"])(h,2),f=u[0],d=u[1],v=o.sri,p=o.sci,y=o.eri,b=o.eci;if(f>1)for(var m=p;m<=b;m+=1){var w=l.getCellOrNew(y+1,m);w.text="=".concat(e,"(").concat(g(m,v),":").concat(g(m,y),")")}else if(d>1){var k=l.getCellOrNew(s,b+1);k.text="=".concat(e,"(").concat(g(p,s),":").concat(g(b,s),")")}}else{var O=l.getCellOrNew(s,c);O.text="=".concat(e,"()")}}else r.range.each((function(n,r){var s=l.getCellOrNew(n,r),c={};if(void 0!==s.style&&(c=F.cloneDeep(a[s.style])),"format"===t)c.format=e,s.style=i.addStyle(c);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var o={};o[t.split("-")[1]]=e,c.font=Object.assign(c.font||{},o),s.style=i.addStyle(c)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(c[t]=e,s.style=i.addStyle(c)):s[t]=e}))}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",i=this.autoFilter,n=this.selector,r=this.rows,a=n.ri,l=n.ci,s=a;this.unsortedRowMap.has(a)&&(s=this.unsortedRowMap.get(a));var c=r.getCell(s,l),o=c?c.text:"";if(this.setCellText(s,l,t,e),i.active()){var h=i.getFilter(l);if(h){var u=h.value.findIndex((function(t){return t===o}));u>=0&&h.value.splice(u,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,i=t.ci,n=e;return this.unsortedRowMap.has(e)&&(n=this.unsortedRowMap.get(e)),this.rows.getCell(n,i)}},{key:"xyInSelectedRect",value:function(t,e){var i=this.getSelectedRect(),n=i.left,r=i.top,a=i.width,l=i.height,s=t-this.cols.indexWidth,c=e-this.rows.height;return s>n&&s<n+a&&c>r&&c<r+l}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,i=this.rows,n=this.cols,r=this.exceptRowSet,a=t.sri,l=t.sci,s=t.eri,c=t.eci;if(a<0&&l<0)return{left:0,l:0,top:0,t:0,scroll:e};var o=n.sumWidth(0,l),h=i.sumHeight(0,a,r),u=i.sumHeight(a,s+1,r),f=n.sumWidth(l,c+1),d=o-e.x,v=h-e.y,g=this.freezeTotalHeight(),p=this.freezeTotalWidth();return p>0&&p>o&&(d=o),g>0&&g>h&&(v=h),{l:o,t:h,left:d,top:v,height:u,width:f,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var i=this.scroll,n=this.merges,r=this.rows,a=this.cols,l=ot.call(this,e,i.y),s=l.ri,c=l.top,o=l.height,h=ht.call(this,t,i.x),u=h.ci,f=h.left,d=h.width;if(-1===u&&(d=a.totalWidth()),-1===s&&(o=r.totalHeight()),s>=0||u>=0){var v=n.getFirstIncludes(s,u);if(v){s=v.sri,u=v.sci;var g=this.cellRect(s,u);f=g.left,c=g.top,d=g.width,o=g.height}}return{ri:s,ci:u,left:f,top:c,width:d,height:o}}},{key:"isSignleSelected",value:function(){var t=this.selector.range,e=t.sri,i=t.sci,r=t.eri,a=t.eci,l=this.getCell(e,i);if(l&&l.merge){var s=Object(n["a"])(l.merge,2),c=s[0],o=s[1];if(e+c===r&&i+o===a)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,i=t.sci,r=t.eri,a=t.eci,l=this.getCell(e,i);if(l&&l.merge){var s=Object(n["a"])(l.merge,2),c=s[0],o=s[1];if(e+c===r&&i+o===a)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,i=this.rows;if(!this.isSignleSelected()){var r=e.size(),a=Object(n["a"])(r,2),l=a[0],s=a[1];if(l>1||s>1){var c=e.range,o=c.sri,h=c.sci;this.changeData((function(){var n=i.getCellOrNew(o,h);n.merge=[l-1,s-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(o,h,n)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSignleSelected()){var i=e.range,n=i.sri,r=i.sci;this.changeData((function(){t.rows.deleteCell(n,r,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,i=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=i.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,i,n){var r=this.autoFilter;r.addFilter(t,i,n),r.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,i=this.rows;if(e.active()){var n=e.sort,r=e.filteredRows((function(t,e){return i.getCell(t,e)})),a=r.rset,l=r.fset,s=Array.from(l),c=Array.from(l);n&&s.sort((function(t,e){return"asc"===n.order?t-e:"desc"===n.order?e-t:0})),this.exceptRowSet=a,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,s.forEach((function(e,i){t.sortedRowMap.set(c[i],e),t.unsortedRowMap.set(e,c[i])}))}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",i=this.selector;this.changeData((function(){t.rows.deleteCells(i.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(i.range)}))}},{key:"insert",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var n=e.selector.range,r=n.sri,a=n.sci,l=e.rows,s=e.merges,c=e.cols,o=r;"row"===t?l.insert(r,i):"column"===t&&(l.insertColumn(a,i),o=a,c.len+=1),s.shift(t,o,i,(function(t,e,i,n){var r=l.getCell(t,e);r.merge[0]+=i,r.merge[1]+=n}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var i=e.rows,r=e.merges,a=e.selector,l=e.cols,s=a.range,c=a.range,o=c.sri,h=c.sci,u=c.eri,f=c.eci,d=a.range.size(),v=Object(n["a"])(d,2),g=v[0],p=v[1],y=o,b=g;"row"===t?i["delete"](o,u):"column"===t&&(i.deleteColumn(h,f),y=s.sci,b=p,l.len-=1),r.shift(t,y,-b,(function(t,e,n,r){var a=i.getCell(t,e);a.merge[0]+=n,a.merge[1]+=r,0===a.merge[0]&&0===a.merge[1]&&delete a.merge}))}))}},{key:"scrollx",value:function(t,e){var i=this.scroll,r=this.freeze,a=this.cols,l=Object(n["a"])(r,2),s=l[1],c=F.rangeReduceIf(s,a.len,0,0,t,(function(t){return a.getWidth(t)})),o=Object(n["a"])(c,3),h=o[0],u=o[1],f=o[2],d=u;t>0&&(d+=f),i.x!==d&&(i.ci=t>0?h:0,i.x=d,e())}},{key:"scrolly",value:function(t,e){var i=this.scroll,r=this.freeze,a=this.rows,l=Object(n["a"])(r,1),s=l[0],c=F.rangeReduceIf(s,a.len,0,0,t,(function(t){return a.getHeight(t)})),o=Object(n["a"])(c,3),h=o[0],u=o[1],f=o[2],d=u;t>0&&(d+=f),i.y!==d&&(i.ri=t>0?h:0,i.y=d,e())}},{key:"cellRect",value:function(t,e){var i=this.rows,r=this.cols,a=r.sumWidth(0,e),l=i.sumHeight(0,t),s=i.getCell(t,e),c=r.getWidth(e),o=i.getHeight(t);if(null!==s&&s.merge){var h=Object(n["a"])(s.merge,2),u=h[0],f=h[1];if(u>0)for(var d=1;d<=u;d+=1)o+=i.getHeight(t+d);if(f>0)for(var v=1;v<=f;v+=1)c+=r.getWidth(e+v)}return{left:a,top:l,width:c,height:o,cell:s}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var i=this.getCell(t,e);return i&&i.text?i.text:""}},{key:"getCellStyle",value:function(t,e){var i=this.getCell(t,e);return i&&void 0!==i.style?this.styles[i.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var i=this.styles,n=this.rows,r=n.getCell(t,e),a=r&&void 0!==r.style?i[r.style]:{};return F.merge(this.defaultStyle(),a)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,i=t.ci;return this.getCellStyleOrDefault(e,i)}},{key:"setCellText",value:function(t,e,i,n){var r=this.rows,a=this.history,l=this.validations;"finished"===n?(r.setCellText(t,e,""),a.add(this.getData()),r.setCellText(t,e,i)):(r.setCellText(t,e,i),this.change(this.getData())),l.validate(t,e,i)}},{key:"freezeIsActive",value:function(){var t=Object(n["a"])(this.freeze,2),e=t[0],i=t[1];return e>0||i>0}},{key:"setFreeze",value:function(t,e){var i=this;this.changeData((function(){i.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var i=this;this.changeData((function(){i.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var i=this;this.changeData((function(){i.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,i=t.showToolbar,n=t.showBottomBar,r=e.height();return n&&(r-=it),i&&(r-=et),r}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=Object(n["a"])(this.freeze,2),e=t[0],i=t[1];return new y(0,0,e-1,i-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,i=t.maxCell(),r=Object(n["a"])(i,2),a=r[0],l=r[1],s=t.sumHeight(0,a+1),c=e.sumWidth(0,l+1);return new y(0,0,a,l,c,s)}},{key:"exceptRowTotalHeight",value:function(t,e){var i=this.exceptRowSet,n=this.rows,r=Array.from(i),a=0;return r.forEach((function(i){if(i<t||i>e){var r=n.getHeight(i);a+=r}})),a}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,i=this.cols,r=this.freeze,a=this.exceptRowSet,l=t.ri,s=t.ci;if(l<=0){var c=Object(n["a"])(r,1);l=c[0]}if(s<=0){var o=Object(n["a"])(r,2);s=o[1]}for(var h=0,u=0,f=[e.len,i.len],d=f[0],v=f[1],g=l;g<e.len;g+=1)if(a.has(g)||(u+=e.getHeight(g),d=g),u>this.viewHeight())break;for(var p=s;p<i.len;p+=1)if(h+=i.getWidth(p),v=p,h>this.viewWidth())break;return new y(l,s,d,v,h,u)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,i=this.selector,r=i.size(),a=Object(n["a"])(r,2),l=a[0],s=a[1],c=i.range,o=c.sri,h=c.sci,u=c.eri,f=c.eci;if(l===t.len)for(var d=h;d<=f;d+=1)e.setHide(d,!0);else if(s===e.len)for(var v=o;v<=u;v+=1)t.setHide(v,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,i){for(var n=0,r=this.rows,a=this.exceptRowSet,l=Object(h["a"])(a),s=0,c=0;c<l.length;c+=1)l[c]<t&&(s+=1);for(var o=t+s;o<=e+s;o+=1)if(a.has(o))s+=1;else{var u=r.getHeight(o);if(u>0&&(i(o,n,u),n+=u,n>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,i){for(var n=0,r=this.cols,a=t;a<=e;a+=1){var l=r.getWidth(a);if(l>0&&(i(a,n,l),n+=l,n>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,i=0;i<e.length;i+=1){var n=e[i];if(F.equals(n,t))return i}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(i){if("merges"===i||"rows"===i||"cols"===i||"validations"===i)e[i].setData(t[i]);else if("freeze"===i){var r=v(t[i]),a=Object(n["a"])(r,2),l=a[0],s=a[1];e.freeze=[s,l]}else"autofilter"===i?e.autoFilter.setData(t[i]):void 0!==t[i]&&(e[i]=t[i])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,i=this.styles,n=this.merges,r=this.rows,a=this.cols,l=this.validations,s=this.autoFilter;return{name:t,freeze:g(e[1],e[0]),styles:i,merges:n.getData(),rows:r.getData(),cols:a.getData(),validations:l.getData(),autofilter:s.getData()}}}]),t}();function ft(t,e,i){t.addEventListener(e,i)}function dt(t,e,i){t.removeEventListener(e,i)}function vt(t){t.xclickoutside&&(dt(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function gt(t,e){t.xclickoutside=function(i){2===i.detail||t.contains(i.target)||(e?e(t):(t.hide(),vt(t)))},ft(window.document.body,"click",t.xclickoutside)}function pt(t,e,i){ft(t,"mousemove",e);var n=t;n.xEvtUp=function(n){dt(t,"mousemove",e),dt(t,"mouseup",t.xEvtUp),i(n)},ft(t,"mouseup",t.xEvtUp)}function yt(t,e,i,n){var r="";Math.abs(t)>Math.abs(e)?(r=t>0?"right":"left",n(r,t,i)):(r=e>0?"down":"up",n(r,e,i))}function bt(t,e){var i=e.move,n=e.end,r=0,a=0;ft(t,"touchstart",(function(t){var e=t.touches[0],i=e.pageX,n=e.pageY;r=i,a=n})),ft(t,"touchmove",(function(t){if(i){var e=t.changedTouches[0],n=e.pageX,l=e.pageY,s=n-r,c=l-a;(Math.abs(s)>10||Math.abs(c)>10)&&(yt(s,c,t,i),r=n,a=l),t.preventDefault()}})),ft(t,"touchend",(function(t){if(n){var e=t.changedTouches[0],i=e.pageX,l=e.pageY,s=i-r,c=l-a;yt(s,c,t,n)}}))}function mt(){var t=new Map;function e(e,i){var n=function(){var n=t.get(e);return Array.isArray(n)&&n.push(i)||!1},r=function(){return t.set(e,[].concat(i))};return t.has(e)&&n()||r()}function i(e,i){var n=function(){var n,r=t.get(e),a=P(r);try{for(a.s();!(n=a.n()).done;){var l=n.value;l.call.apply(l,[null].concat(Object(h["a"])(i)))}}catch(s){a.e(s)}finally{a.f()}};return t.has(e)&&n()}function n(e,i){var n=function(){var n=t.get(e),r=n.indexOf(i);return r>=0&&n.splice(r,1)&&0===t.get(e).length&&t["delete"](e)};return t.has(e)&&n()}function r(t,i){var r=function e(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];i.call.apply(i,[null].concat(a)),n(t,e)};return e(t,r)}function a(){t.clear()}return{get current(){return t},on:e,once:r,fire:i,removeListener:n,removeAllListeners:a}}var wt="x-spreadsheet",kt=(window.devicePixelRatio,function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;Object(a["default"])(this,t),this.moving=!1,this.vertical=i,this.el=o("div","".concat(wt,"-resizer ").concat(i?"vertical":"horizontal")).children(this.unhideHoverEl=o("div","".concat(wt,"-resizer-hover")).on("dblclick.stop",(function(t){return e.mousedblclickHandler(t)})).css("position","absolute").hide(),this.hoverEl=o("div","".concat(wt,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=o("div","".concat(wt,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=n,this.unhideFn=function(){}}return Object(l["default"])(t,[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var i=this.moving,n=this.vertical,r=this.hoverEl,a=this.lineEl,l=this.el,s=this.unhideHoverEl;if(!i){this.cRect=t;var c=t.left,o=t.top,h=t.width,u=t.height;l.offset({left:n?c+h-5:c,top:n?o:o+u-5}).show(),r.offset({width:n?5:h,height:n?u:5}),a.offset({width:n?0:e.width,height:n?e.height:0}),s.offset({left:n?5-h:c,top:n?o:5-u,width:n?5:h,height:n?u:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,i=t,n=this.el,r=this.lineEl,a=this.cRect,l=this.vertical,s=this.minDistance,c=l?a.width:a.height;r.show(),pt(window,(function(t){e.moving=!0,null!==i&&1===t.buttons&&(l?(c+=t.movementX,c>s&&n.css("left","".concat(a.left+c,"px"))):(c+=t.movementY,c>s&&n.css("top","".concat(a.top+c,"px"))),i=t)}),(function(){i=null,r.hide(),e.moving=!1,e.hide(),e.finishedFn&&(c<s&&(c=s),e.finishedFn(a,c))}))}}]),t}()),Ot=function(){function t(e){var i=this;Object(a["default"])(this,t),this.vertical=e,this.moveFn=null,this.el=o("div","".concat(wt,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=o("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(t){var e=t.target,n=e.scrollTop,r=e.scrollLeft;i.moveFn&&i.moveFn(i.vertical?n:r,t)}))}return Object(l["default"])(t,[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var i=t-1;if(e>i){var n=this.vertical?"height":"width";this.el.css(n,"".concat(i-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(n,"".concat(e,"px"))}else this.el.hide();return this}}]),t}(),xt=3,jt=10,Ct=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(a["default"])(this,t),this.useHideInput=i,this.inputChange=function(){},this.cornerEl=o("div","".concat(wt,"-selector-corner")),this.areaEl=o("div","".concat(wt,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=o("div","".concat(wt,"-selector-clipboard")).hide(),this.autofillEl=o("div","".concat(wt,"-selector-autofill")).hide(),this.el=o("div","".concat(wt,"-selector")).css("z-index","".concat(jt)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),i&&(this.hideInput=o("input","").on("compositionend",(function(t){e.inputChange(t.target.value)})),this.el.child(this.hideInputDiv=o("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=o("div","hide-input").child(this.hideInput))),jt+=1}return Object(l["default"])(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,i=t.top,n=t.width,r=t.height,a={width:n-xt+.8,height:r-xt+.8,left:e-.8,top:i-.8};this.areaEl.offset(a).show(),this.useHideInput&&(this.hideInputDiv.offset(a),this.hideInput.val("").focus())}},{key:"setClipboardOffset",value:function(t){var e=t.left,i=t.top,n=t.width,r=t.height;this.clipboardEl.offset({left:e,top:i,width:n-5,height:r-5})}},{key:"showAutofill",value:function(t){var e=t.left,i=t.top,n=t.width,r=t.height;this.autofillEl.offset({width:n-xt,height:r-xt,left:e,top:i}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function Et(t){var e=this.data,i=t.left,n=t.top,r=t.width,a=t.height,l=t.scroll,s=t.l,c=t.t,o=e.freezeTotalWidth(),h=e.freezeTotalHeight(),u=i-o;o>s&&(u-=l.x);var f=n-h;return h>c&&(f-=l.y),{left:u,top:f,width:r,height:a}}function St(t){var e=this.data,i=t.left,n=t.width,r=t.height,a=t.l,l=t.t,s=t.scroll,c=e.freezeTotalWidth(),o=i-c;return c>a&&(o-=s.x),{left:o,top:l,width:n,height:r}}function Dt(t){var e=this.data,i=t.top,n=t.width,r=t.height,a=t.l,l=t.t,s=t.scroll,c=e.freezeTotalHeight(),o=i-c;return c>l&&(o-=s.y),{left:a,top:o,width:n,height:r}}function Tt(t){var e=this.br;e.setAreaOffset(Et.call(this,t))}function At(t){var e=this.tl;e.setAreaOffset(t)}function Rt(t){var e=this.t;e.setAreaOffset(St.call(this,t))}function zt(t){var e=this.l;e.setAreaOffset(Dt.call(this,t))}function It(t){var e=this.l;e.setClipboardOffset(Dt.call(this,t))}function Ht(t){var e=this.br;e.setClipboardOffset(Et.call(this,t))}function Mt(t){var e=this.tl;e.setClipboardOffset(t)}function Nt(t){var e=this.t;e.setClipboardOffset(St.call(this,t))}function Ft(t){Tt.call(this,t),At.call(this,t),Rt.call(this,t),zt.call(this,t)}function Wt(t){Ht.call(this,t),Mt.call(this,t),Nt.call(this,t),It.call(this,t)}var Vt=function(){function t(e){var i=this;Object(a["default"])(this,t),this.inputChange=function(){},this.data=e,this.br=new Ct(!0),this.t=new Ct,this.l=new Ct,this.tl=new Ct,this.br.inputChange=function(t){i.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=o("div","".concat(wt,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,jt+=1}return Object(l["default"])(t,[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,i=this.t,n=this.l,r=this.br,a=t.freezeTotalHeight(),l=t.freezeTotalWidth();a>0||l>0?(e.setOffset({width:l,height:a}),i.setOffset({left:l,height:a}),n.setOffset({top:a,width:l}),r.setOffset({left:l,top:a})):(e.hide(),i.hide(),n.hide(),r.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Ft.call(this,t),Wt.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Tt.call(this,t),Rt.call(this,t),Ht.call(this,e),Nt.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Tt.call(this,t),zt.call(this,t),Ht.call(this,e),It.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,r=n.calSelectedRangeByStart(t,e),a=r.sri,l=r.sci;if(i){var s=t,c=e;t<0&&(s=0),e<0&&(c=0),n.selector.setIndexes(s,c),this.indexes=[s,c]}this.moveIndexes=[a,l],this.range=r,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,r=this.lastri,a=this.lastci;if(i){if(t===r&&e===a)return;this.lastri=t,this.lastci=e}this.range=n.calSelectedRangeByEnd(t,e),Ft.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,i=t.eci;this.setEnd(e,i)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var i=this.range,n=i.sri,r=i.sci,a=i.eri,l=i.eci,s=t,c=e,o=n-t,h=r-e,u=a-t,f=l-e;if(h>0)this.arange=new y(n,c,a,r-1);else if(o>0)this.arange=new y(s,r,n-1,l);else if(f<0)this.arange=new y(n,l+1,a,c);else{if(!(u<0))return void(this.arange=null);this.arange=new y(a+1,r,s,l)}if(null!==this.arange){var d=this.data.getRect(this.arange);d.width+=2,d.height+=2;var v=this.br,g=this.l,p=this.t,b=this.tl;v.showAutofill(Et.call(this,d)),g.showAutofill(Dt.call(this,d)),p.showAutofill(St.call(this,d)),b.showAutofill(d)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();Wt.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideClipboard()}))}}]),t}();function _t(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function Pt(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function qt(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function Bt(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:_t.call(this,t);break;case 39:t.stopPropagation();break;case 40:Pt.call(this,t);break;case 13:qt.call(this,t);break;case 9:qt.call(this,t);break;default:t.stopPropagation();break}}var Lt=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";Object(a["default"])(this,t),this.filterItems=[],this.items=e,this.el=o("div","".concat(wt,"-suggest")).css("width",n).hide(),this.itemClick=i,this.itemIndex=-1}return Object(l["default"])(t,[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),vt(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,i=this,n=this.items;if(/^\s*$/.test(t)||(n=n.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),n=n.map((function(t){var e=t.title;e?"function"===typeof e&&(e=e()):e=t;var n=o("div","".concat(wt,"-item")).child(e).on("click.stop",(function(){i.itemClick(t),i.hide()}));return t.label&&n.child(o("div","label").html(t.label)),n})),this.filterItems=n,!(n.length<=0)){var r=this.el;(e=r.html("")).children.apply(e,Object(h["a"])(n)).show(),gt(r.parent(),(function(){i.hide()}))}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return Bt.call(e,t)}))}}]),t}(),Ut=i("Ji7U"),Yt=i("LK+K"),$t=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t){var n;return Object(a["default"])(this,i),n=e.call(this,"div","".concat(wt,"-icon")),n.iconNameEl=o("div","".concat(wt,"-icon-img ").concat(t)),n.child(n.iconNameEl),n}return Object(l["default"])(i,[{key:"setName",value:function(t){this.iconNameEl.className("".concat(wt,"-icon-img ").concat(t))}}]),i}(c);function Xt(t,e){t.setMonth(t.getMonth()+e)}function Jt(t,e){var i=new Date(t);return i.setDate(e-t.getDay()+1),i}function Kt(t,e,i){for(var n=new Date(t,e,1,23,59,59),r=[[],[],[],[],[],[]],a=0;a<6;a+=1)for(var l=0;l<7;l+=1){var s=7*a+l,c=Jt(n,s),o=c.getMonth()!==e,h=c.getMonth()===i.getMonth()&&c.getDate()===i.getDate();r[a][l]={d:c,disabled:o,active:h}}return r}var Zt=function(){function t(e){var i,n=this;Object(a["default"])(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=o("div","calendar-header-left"),this.bodyEl=o("tbody",""),this.buildAll(),this.el=o("div","x-spreadsheet-calendar").children(o("div","calendar-header").children(this.headerLeftEl,o("div","calendar-header-right").children(o("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new $t("chevron-left")),o("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new $t("chevron-right")))),o("table","calendar-body").children(o("thead","").child((i=o("tr","")).children.apply(i,Object(h["a"])(Y("calendar.weeks").map((function(t){return o("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}}return Object(l["default"])(t,[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){var t=this.value;Xt(t,-1),this.buildAll()}},{key:"next",value:function(){var t=this.value;Xt(t,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(Y("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,i=this.value,n=this.cvalue,r=this.bodyEl,a=Kt(i.getFullYear(),i.getMonth(),n),l=a.map((function(t){var i,n=t.map((function(t){var i="cell";return t.disabled&&(i+=" disabled"),t.active&&(i+=" active"),o("td","").child(o("div",i).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(i=o("tr","")).children.apply(i,Object(h["a"])(n))}));(t=r.html("")).children.apply(t,Object(h["a"])(l))}}]),t}(),Gt=function(){function t(){Object(a["default"])(this,t),this.calendar=new Zt(new Date),this.el=o("div","".concat(wt,"-datepicker")).child(this.calendar.el).hide()}return Object(l["default"])(t,[{key:"setValue",value:function(t){var e=this.calendar;return"string"===typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(i){t(i),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}]),t}();function Qt(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,i=this.textEl,n=this.areaOffset,r=t.split("\n"),a=Math.max.apply(Math,Object(h["a"])(r.map((function(t){return t.length})))),l=e.offset(),s=l.width/t.length,c=(a+1)*s+5,o=this.viewFn().width-n.left-s,u=r.length;if(c>n.width){var f=c;c>o&&(f=o,u+=parseInt(c/o,10),u+=c%o>0?1:0),i.css("width","".concat(f,"px"))}u*=this.rowHeight,u>n.height&&i.css("height","".concat(u,"px"))}}function te(t,e){var i=t.target,n=i.value,r=i.selectionEnd,a="".concat(n.slice(0,r)).concat(e).concat(n.slice(r));i.value=a,i.setSelectionRange(r+1,r+1),this.inputText=a,this.textlineEl.html(a),Qt.call(this)}function ee(t){var e=t.keyCode,i=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&i&&(te.call(this,t,"\n"),t.stopPropagation()),13!==e||i||t.preventDefault()}function ie(t){var e=t.target.value,i=this.suggest,n=this.textlineEl,r=this.validator,a=this.cell;if(null!==a)if("editable"in a&&!0===a.editable||void 0===a.editable){if(this.inputText=e,r)"list"===r.type?i.search(e):i.hide();else{var l=e.lastIndexOf("=");-1!==l?i.search(e.substring(l+1)):i.hide()}n.html(e),Qt.call(this),this.change("input",e)}else t.target.value=a.text;else{if(this.inputText=e,r)"list"===r.type?i.search(e):i.hide();else{var s=e.lastIndexOf("=");-1!==s?i.search(e.substring(s+1)):i.hide()}n.html(e),Qt.call(this),this.change("input",e)}}function ne(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function re(t,e){var i=this.textEl,n=this.textlineEl;i.el.blur(),i.val(t),n.html(t),ne.call(this,e)}function ae(t){var e=this.inputText,i=this.validator,n=0;if(i&&"list"===i.type)this.inputText=t,n=this.inputText.length;else{var r=e.lastIndexOf("="),a=e.substring(0,r+1),l=e.substring(r+1);l=-1!==l.indexOf(")")?l.substring(l.indexOf(")")):"",this.inputText="".concat(a+t.key,"("),n=this.inputText.length,this.inputText+=")".concat(l)}re.call(this,this.inputText,n)}function le(){this.suggest.setItems(this.formulas)}function se(t){var e=t.getMonth()+1,i=t.getDate();return e<10&&(e="0".concat(e)),i<10&&(i="0".concat(i)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(i)}var ce=function(){function t(e,i,n){var r=this;Object(a["default"])(this,t),this.viewFn=i,this.rowHeight=n,this.formulas=e,this.suggest=new Lt(e,(function(t){ae.call(r,t)})),this.datepicker=new Gt,this.datepicker.change((function(t){r.setText(se(t)),r.clear()})),this.areaEl=o("div","".concat(wt,"-editor-area")).children(this.textEl=o("textarea","").on("input",(function(t){return ie.call(r,t)})).on("paste.stop",(function(){})).on("keydown",(function(t){return ee.call(r,t)})),this.textlineEl=o("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=o("div","".concat(wt,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}return Object(l["default"])(t,[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),le.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",i=this.textEl,n=this.areaEl,r=this.suggest,a=this.freeze,l=this.el;if(t){this.areaOffset=t;var s=t.left,c=t.top,o=t.width,h=t.height,u=t.l,f=t.t,d={left:0,top:0};a.w>u&&a.h>f||(a.w<u&&a.h<f?(d.left=a.w,d.top=a.h):a.w>u?d.top=a.h:a.h>f&&(d.left=a.w)),l.offset(d),n.offset({left:s-d.left-.8,top:c-d.top-.8}),i.offset({width:o-9+.8,height:h-3+.8});var v={left:0};v[e]=h,r.setOffset(v),r.hide()}}},{key:"setCell",value:function(t,e){var i=this.el,n=this.datepicker,r=this.suggest;i.show(),this.cell=t;var a=t&&t.text||"";if(this.setText(a),this.validator=e,e){var l=e.type;"date"===l&&(n.show(),/^\s*$/.test(a)||n.setValue(a)),"list"===l&&(r.setItems(e.values()),r.search(""))}}},{key:"setText",value:function(t){this.inputText=t,re.call(this,t,t.length),Qt.call(this)}}]),t}(),oe=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(a["default"])(this,i),n=e.call(this,"div","".concat(wt,"-button ").concat(r)),n.child(Y("button.".concat(t))),n}return i}(c);function he(){return window.devicePixelRatio||1}function ue(){return he()-.5}function fe(t){return parseInt(t*he(),10)}function de(t){var e=fe(t);return e>0?e-.5:.5}var ve=function(){function t(e,i,n,r){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Object(a["default"])(this,t),this.x=e,this.y=i,this.width=n,this.height=r,this.padding=l,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return Object(l["default"])(t,[{key:"setBorders",value:function(t){var e=t.top,i=t.bottom,n=t.left,r=t.right;e&&(this.borderTop=e),r&&(this.borderRight=r),i&&(this.borderBottom=i),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,i=this.padding,n=this.x;return"left"===t?n+=i:"center"===t?n+=e/2:"right"===t&&(n+=e-i),n}},{key:"texty",value:function(t,e){var i=this.height,n=this.padding,r=this.y;return"top"===t?r+=n:"middle"===t?r+=i/2-e/2:"bottom"===t&&(r+=i-n-e),r}},{key:"topxys",value:function(){var t=this.x,e=this.y,i=this.width;return[[t,e],[t+i,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,i=this.width,n=this.height;return[[t+i,e],[t+i,e+n]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,i=this.width,n=this.height;return[[t,e+n],[t+i,e+n]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y,i=this.height;return[[t,e],[t,e+i]]}}]),t}();function ge(t,e,i,n,r,a,l){var s={x:0,y:0};"underline"===t?s.y="bottom"===r?0:"top"===r?-(a+2):-a/2:"strike"===t&&("bottom"===r?s.y=a/2:"top"===r&&(s.y=-(a/2+2))),"center"===n?s.x=l/2:"right"===n&&(s.x=l),this.line([e-s.x,i-s.y],[e-s.x+l,i-s.y])}var pe=function(){function t(e,i,n){Object(a["default"])(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(i,n),this.ctx.scale(he(),he())}return Object(l["default"])(t,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=fe(t),this.el.height=fe(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,i=t.height;return this.ctx.clearRect(0,0,e,i),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(fe(t),fe(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,i,n){return this.ctx.clearRect(t,e,i,n),this}},{key:"fillRect",value:function(t,e,i,n){return this.ctx.fillRect(fe(t)-.5,fe(e)-.5,fe(i),fe(n)),this}},{key:"fillText",value:function(t,e,i){return this.ctx.fillText(t,fe(e),fe(i)),this}},{key:"text",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this.ctx,l=n.align,s=n.valign,c=n.font,o=n.color,h=n.strike,u=n.underline,f=e.textx(l);a.save(),a.beginPath(),this.attr({textAlign:l,textBaseline:s,font:"".concat(c.italic?"italic":""," ").concat(c.bold?"bold":""," ").concat(fe(c.size),"px ").concat(c.name),fillStyle:o,strokeStyle:o});var d="".concat(t).split("\n"),v=e.innerWidth(),g=[];d.forEach((function(t){var e=a.measureText(t).width;if(r&&e>fe(v)){for(var i={w:0,len:0,start:0},n=0;n<t.length;n+=1)i.w>=fe(v)&&(g.push(t.substr(i.start,i.len)),i={w:0,len:0,start:n}),i.len+=1,i.w+=a.measureText(t[n]).width+1;i.len>0&&g.push(t.substr(i.start,i.len))}else g.push(t)}));var p=(g.length-1)*(c.size+2),y=e.texty(s,p);return g.forEach((function(t){var e=a.measureText(t).width;i.fillText(t,f,y),h&&ge.call(i,"strike",f,y,l,s,c.size,e),u&&ge.call(i,"underline",f,y,l,s,c.size,e),y+=c.size+2})),a.restore(),this}},{key:"border",value:function(t,e){var i=this.ctx;return i.lineWidth=ue,i.strokeStyle=e,"medium"===t?i.lineWidth=fe(2)-.5:"thick"===t?i.lineWidth=fe(3):"dashed"===t?i.setLineDash([fe(3),fe(2)]):"dotted"===t?i.setLineDash([fe(1),fe(1)]):"double"===t&&i.setLineDash([fe(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],i=Object(n["a"])(e,2),r=i[0],a=i[1];t.moveTo(de(r),de(a));for(var l=1;l<arguments.length;l+=1){var s=l<0||arguments.length<=l?void 0:arguments[l],c=Object(n["a"])(s,2),o=c[0],h=c[1];t.lineTo(de(o),de(h))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var i=t.borderTop,n=t.borderRight,r=t.borderBottom,a=t.borderLeft;i&&(this.border.apply(this,Object(h["a"])(i)),this.line.apply(this,Object(h["a"])(t.topxys()))),n&&(this.border.apply(this,Object(h["a"])(n)),this.line.apply(this,Object(h["a"])(t.rightxys()))),r&&(this.border.apply(this,Object(h["a"])(r)),this.line.apply(this,Object(h["a"])(t.bottomxys()))),a&&(this.border.apply(this,Object(h["a"])(a)),this.line.apply(this,Object(h["a"])(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,i=t.x,n=t.y,r=t.width,a=t.height,l=i+r-15,s=n+a-15;e.save(),e.beginPath(),e.moveTo(fe(l),fe(s)),e.lineTo(fe(l+8),fe(s)),e.lineTo(fe(l+4),fe(s+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,i=t.x,n=t.y,r=t.width,a=i+r-1;e.save(),e.beginPath(),e.moveTo(fe(a-8),fe(n-1)),e.lineTo(fe(a),fe(n-1)),e.lineTo(fe(a),fe(n+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,i=t.x,n=t.y,r=t.width,a=i+r-1;e.save(),e.beginPath(),e.moveTo(fe(a-8),fe(n-1)),e.lineTo(fe(a),fe(n-1)),e.lineTo(fe(a),fe(n+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var i=this.ctx,n=t.x,r=t.y,a=t.width,l=t.height,s=t.bgcolor;i.save(),i.beginPath(),i.fillStyle=s||"#fff",i.rect(de(n+1),de(r+1),fe(a-2),fe(l-2)),i.clip(),i.fill(),e(),i.restore()}}]),t}(),ye=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],be=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function me(t){for(var e=0;e<be.length;e+=1){var i=be[e];if(i.pt===t)return i.px}return t}var we=function(t){for(var e=[],i=[],r=[],a=0,l="",s=1,c="",o=0;o<t.length;o+=1){var h=t.charAt(o);if(" "!==h){if(h>="a"&&h<="z")r.push(h.toUpperCase());else if(h>="0"&&h<="9"||h>="A"&&h<="Z"||"."===h)r.push(h);else if('"'===h){o+=1;while('"'!==t.charAt(o))r.push(t.charAt(o)),o+=1;i.push('"'.concat(r.join(""))),r=[]}else if("-"===h&&/[+\-*/,(]/.test(c))r.push(h);else{if("("!==h&&r.length>0&&i.push(r.join("")),")"===h){var u=e.pop();if(2===a)try{for(var f=v(i.pop()),d=Object(n["a"])(f,2),p=d[0],y=d[1],b=v(i.pop()),m=Object(n["a"])(b,2),w=m[0],k=m[1],O=0,x=w;x<=p;x+=1)for(var j=k;j<=y;j+=1)i.push(g(x,j)),O+=1;i.push([u,O])}catch(D){}else if(1===a||3===a)3===a&&i.push(l),i.push([u,s]),s=1;else while("("!==u){if(i.push(u),e.length<=0)break;u=e.pop()}a=0}else if("="===h||">"===h||"<"===h){var C=t.charAt(o+1);l=h,"="!==C&&"-"!==C||(l+=C,o+=1),a=3}else if(":"===h)a=2;else if(","===h)3===a&&i.push(l),a=1,s+=1;else if("("===h&&r.length>0)e.push(r.join(""));else{if(e.length>0&&("+"===h||"-"===h)){var E=e[e.length-1];if("("!==E&&i.push(e.pop()),"*"===E||"/"===E)while(e.length>0){if(E=e[e.length-1],"("===E)break;i.push(e.pop())}}else if(e.length>0){var S=e[e.length-1];"*"!==S&&"/"!==S||i.push(e.pop())}e.push(h)}r=[]}c=h}}r.length>0&&i.push(r.join(""));while(e.length>0)i.push(e.pop());return i},ke=function(t,e){var i=Object(n["a"])(t,1),r=i[0],a=t;if('"'===r)return t.substring(1);var l=1;if("-"===r&&(a=t.substring(1),l=-1),a[0]>="0"&&a[0]<="9")return l*Number(a);var s=v(a),c=Object(n["a"])(s,2),o=c[0],h=c[1];return l*e(o,h)},Oe=function(t,e,i,r){for(var a=[],l=0;l<t.length;l+=1){var s=t[l],c=s[0];if("+"===s){var o=a.pop();a.push(N("+",a.pop(),o))}else if("-"===s)if(1===a.length){var h=a.pop();a.push(N("*",h,-1))}else{var u=a.pop();a.push(N("-",a.pop(),u))}else if("*"===s)a.push(N("*",a.pop(),a.pop()));else if("/"===s){var f=a.pop();a.push(N("/",a.pop(),f))}else if("="===c||">"===c||"<"===c){var d=a.pop();Number.isNaN(d)||(d=Number(d));var v=a.pop();Number.isNaN(v)||(v=Number(v));var g=!1;"="===c?g=v===d:">"===s?g=v>d:">="===s?g=v>=d:"<"===s?g=v<d:"<="===s&&(g=v<=d),a.push(g)}else if(Array.isArray(s)){for(var p=Object(n["a"])(s,2),y=p[0],b=p[1],m=[],w=0;w<b;w+=1)m.push(a.pop());a.push(e[y].render(m.reverse()))}else{if(r.includes(s))return 0;(c>="a"&&c<="z"||c>="A"&&c<="Z")&&r.push(s),a.push(ke(s,i)),r.pop()}}return a[0]},xe=function t(e,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===e[0]){var a=we(e.substring(1));return a.length<=0?e:Oe(a,i,(function(e,a){return t(n(e,a),i,n,r)}),r)}return e},je={render:xe},Ce=[{key:"SUM",title:$("formula.sum"),render:function(t){return t.reduce((function(t,e){return N("+",t,e)}),0)}},{key:"AVERAGE",title:$("formula.average"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)/t.length}},{key:"MAX",title:$("formula.max"),render:function(t){return Math.max.apply(Math,Object(h["a"])(t.map((function(t){return Number(t)}))))}},{key:"MIN",title:$("formula.min"),render:function(t){return Math.min.apply(Math,Object(h["a"])(t.map((function(t){return Number(t)}))))}},{key:"IF",title:$("formula._if"),render:function(t){var e=Object(n["a"])(t,3),i=e[0],r=e[1],a=e[2];return i?r:a}},{key:"AND",title:$("formula.and"),render:function(t){return t.every((function(t){return t}))}},{key:"OR",title:$("formula.or"),render:function(t){return t.some((function(t){return t}))}},{key:"CONCAT",title:$("formula.concat"),render:function(t){return t.join("")}}],Ee=Ce,Se={};Ce.forEach((function(t){Se[t.key]=t}));var De=function(t){return t},Te=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=Number(t).toFixed(2).toString(),i=e.split("\\."),n=Object(s["a"])(i),r=n[0],a=n.slice(1);return[r.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(Object(h["a"])(a))}return t},Ae=[{key:"normal",title:$("format.normal"),type:"string",render:De},{key:"text",title:$("format.text"),type:"string",render:De},{key:"number",title:$("format.number"),type:"number",label:"1,000.12",render:Te},{key:"percent",title:$("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:$("format.rmb"),type:"number",label:"\uffe510.00",render:function(t){return"\uffe5".concat(Te(t))}},{key:"usd",title:$("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(Te(t))}},{key:"eur",title:$("format.eur"),type:"number",label:"\u20ac10.00",render:function(t){return"\u20ac".concat(Te(t))}},{key:"date",title:$("format.date"),type:"date",label:"26/09/2008",render:De},{key:"time",title:$("format.time"),type:"date",label:"15:59:00",render:De},{key:"datetime",title:$("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:De},{key:"duration",title:$("format.duration"),type:"date",label:"24:01:00",render:De}],Re={};Ae.forEach((function(t){Re[t.key]=t}));var ze=5,Ie={fillStyle:"#f4f5f8"},He={fillStyle:"#fff",lineWidth:ue,strokeStyle:"#e6e6e6"};function Me(){return{textAlign:"center",textBaseline:"middle",font:"500 ".concat(fe(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:ue(),strokeStyle:"#e6e6e6"}}function Ne(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=t.cellRect(e,i),a=r.left,l=r.top,s=r.width,c=r.height;return new ve(a,l+n,s,c,ze)}function Fe(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=e.sortedRowMap,l=e.rows,s=e.cols;if(!l.isHide(i)&&!s.isHide(n)){var c=i;a.has(i)&&(c=a.get(i));var o=e.getCell(c,n);if(null!==o){var h=!1;"editable"in o&&!1===o.editable&&(h=!0);var u=e.getCellStyleOrDefault(c,n),f=Ne(e,i,n,r);f.bgcolor=u.bgcolor,void 0!==u.border&&(f.setBorders(u.border),t.strokeBorders(f)),t.rect(f,(function(){var r="";r=e.settings.evalPaused?o.text||"":je.render(o.text||"",Se,(function(t,i){return e.getCellTextOrDefault(i,t)})),u.format&&(r=Re[u.format].render(r));var a=Object.assign({},u.font);a.size=me(a.size),t.text(r,f,{align:u.align,valign:u.valign,font:a,color:u.color,strike:u.strike,underline:u.underline},u.textwrap);var l=e.validations.getError(i,n);l&&t.error(f),h&&t.frozen(f)}))}}}function We(t){var e=this.data,i=this.draw;if(t){var n=e.autoFilter;if(!n.active())return;var r=n.hrange();t.intersects(r)&&r.each((function(t,n){var r=Ne(e,t,n);i.dropdown(r)}))}}function Ve(t,e,i,n,r){var a=this.draw,l=this.data;a.save(),a.translate(e,i).translate(n,r);var s=l.exceptRowSet,c=function(t){var e=s.has(t);if(e){var i=l.rows.getHeight(t);a.translate(0,-i)}return!e},o=l.exceptRowTotalHeight(t.sri,t.eri);a.save(),a.translate(0,-o),t.each((function(t,e){Fe(a,l,t,e)}),(function(t){return c(t)})),a.restore();var h=new Set;a.save(),a.translate(0,-o),l.eachMergesInView(t,(function(t){var e=t.sri,i=t.sci,n=t.eri;if(s.has(e)){if(!h.has(e)){h.add(e);var r=l.rows.sumHeight(e,n+1);a.translate(0,-r)}}else Fe(a,l,e,i)})),a.restore(),We.call(this,t),a.restore()}function _e(t,e,i,n){var r=this.draw;r.save(),r.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,i,n),r.restore()}function Pe(t,e,i,n,r,a){var l=this,s=this.draw,c=this.data,o=e.h,h=e.w,u=a+n,d=r+i;s.save(),s.attr(Ie),"all"!==t&&"left"!==t||s.fillRect(0,u,i,o),"all"!==t&&"top"!==t||s.fillRect(d,0,h,n);var v=c.selector.range,g=v.sri,p=v.sci,y=v.eri,b=v.eci;s.attr(Me()),"all"!==t&&"left"!==t||(c.rowEach(e.sri,e.eri,(function(t,e,n){var r=u+e,a=t;s.line([0,r],[i,r]),g<=a&&a<y+1&&_e.call(l,0,r,i,n),s.fillText(a+1,i/2,r+n/2),t>0&&c.rows.isHide(t-1)&&(s.save(),s.attr({strokeStyle:"#c6c6c6"}),s.line([5,r+5],[i-5,r+5]),s.restore())})),s.line([0,o+u],[i,o+u]),s.line([i,u],[i,o+u])),"all"!==t&&"top"!==t||(c.colEach(e.sci,e.eci,(function(t,e,i){var r=d+e,a=t;s.line([r,0],[r,n]),p<=a&&a<b+1&&_e.call(l,r,0,i,n),s.fillText(f(a),r+i/2,n/2),t>0&&c.cols.isHide(t-1)&&(s.save(),s.attr({strokeStyle:"#c6c6c6"}),s.line([r+5,5],[r+5,n-5]),s.restore())})),s.line([h+d,0],[h+d,n]),s.line([0,n],[h+d,n])),s.restore()}function qe(t,e){var i=this.draw;i.save(),i.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),i.restore()}function Be(t,e,i,n,r){var a=t.sri,l=t.sci,s=t.eri,c=t.eci,o=t.w,h=t.h,u=this.draw,f=this.data,d=f.settings;u.save(),u.attr(He).translate(e+n,i+r),d.showGrid?(f.rowEach(a,s,(function(t,e,i){t!==a&&u.line([0,e],[o,e]),t===s&&u.line([0,e+i],[o,e+i])})),f.colEach(l,c,(function(t,e,i){t!==l&&u.line([e,0],[e,h]),t===c&&u.line([e+i,0],[e+i,h])})),u.restore()):u.restore()}function Le(t,e,i,n){var r=this.draw,a=this.data,l=a.viewWidth()-t,s=a.viewHeight()-e;r.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),r.line([0,n],[l,n]),r.line([i,0],[i,s]),r.restore()}var Ue=function(){function t(e,i){Object(a["default"])(this,t),this.el=e,this.draw=new pe(e,i.viewWidth(),i.viewHeight()),this.data=i}return Object(l["default"])(t,[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,i=t.cols,r=i.indexWidth,a=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var l=t.viewRange(),s=t.freezeTotalWidth(),c=t.freezeTotalHeight(),o=t.scroll,h=o.x,u=o.y;Be.call(this,l,r,a,s,c),Ve.call(this,l,r,a,-h,-u),Pe.call(this,"all",l,r,a,s,c),qe.call(this,r,a);var f=Object(n["a"])(t.freeze,2),d=f[0],v=f[1];if(d>0||v>0){if(d>0){var g=l.clone();g.sri=0,g.eri=d-1,g.h=c,Be.call(this,g,r,a,s,0),Ve.call(this,g,r,a,-h,0),Pe.call(this,"top",g,r,a,s,0)}if(v>0){var p=l.clone();p.sci=0,p.eci=v-1,p.w=s,Be.call(this,p,r,a,0,c),Pe.call(this,"left",p,r,a,0,c),Ve.call(this,p,r,a,0,-u)}var y=t.freezeViewRange();Be.call(this,y,r,a,0,0),Pe.call(this,"all",y,r,a,0,0),Ve.call(this,y,r,a,0,0),Le.call(this,r,a,s,c)}}},{key:"clear",value:function(){this.draw.clear()}}]),t}(),Ye=Ue,$e=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],Xe=["landscape","portrait"];function Je(t){return parseInt(96*t,10)}function Ke(t){"cancel"===t?this.el.hide():this.toPrint()}function Ze(t){var e=this.paper,i=t.target.value,n=$e[i];e.w=Je(n[1]),e.h=Je(n[2]),this.preview()}function Ge(t){var e=this.paper,i=t.target.value,n=Xe[i];e.orientation=n,this.preview()}var Qe=function(){function t(e){var i,n;Object(a["default"])(this,t),this.paper={w:Je($e[0][1]),h:Je($e[0][2]),padding:50,orientation:Xe[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=o("div","".concat(wt,"-print")).children(o("div","".concat(wt,"-print-bar")).children(o("div","-title").child("Print settings"),o("div","-right").children(o("div","".concat(wt,"-buttons")).children(new oe("cancel").on("click",Ke.bind(this,"cancel")),new oe("next","primary").on("click",Ke.bind(this,"next"))))),o("div","".concat(wt,"-print-content")).children(this.contentEl=o("div","-content"),o("div","-sider").child(o("form","").children(o("fieldset","").children(o("label","").child("".concat(Y("print.size"))),(i=o("select","")).children.apply(i,Object(h["a"])($e.map((function(t,e){return o("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))})))).on("change",Ze.bind(this))),o("fieldset","").children(o("label","").child("".concat(Y("print.orientation"))),(n=o("select","")).children.apply(n,Object(h["a"])(Xe.map((function(t,e){return o("option","").attr("value",e).child("".concat(Y("print.orientations")[e]))})))).on("change",Ge.bind(this))))))).hide()}return Object(l["default"])(t,[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,i=this.paper,n=i.width,r=i.height,a=i.padding,l=n-2*a,s=r-2*a,c=e.contentRange(),h=parseInt(c.h/s,10)+1,u=l/c.w,f=a,d=a;u>1&&(f+=(l-c.w)/2);var v=0,g=0;this.contentEl.html(""),this.canvases=[];for(var p={sri:0,sci:0,eri:0,eci:0},y=function(i){var a=0,l=0,h=o("div","".concat(wt,"-canvas-card")),y=o("canvas","".concat(wt,"-canvas"));t.canvases.push(y.el);var b=new pe(y.el,n,r);for(b.save(),b.translate(f,d),u<1&&b.scale(u,u);v<=c.eri;v+=1){var m=e.rows.getHeight(v);if(a+=m,!(a<s)){l=-(a-m);break}for(var w=0;w<=c.eci;w+=1)Fe(b,e,v,w,g),p.eci=w}p.eri=v,b.restore(),b.save(),b.translate(f,d),u<1&&b.scale(u,u);var k=g;e.eachMergesInView(p,(function(t){var i=t.sri,n=t.sci;Fe(b,e,i,n,k)})),b.restore(),p.sri=p.eri,p.sci=p.eci,g+=l,t.contentEl.child(o("div","".concat(wt,"-canvas-card-wraper")).child(h.child(y)))},b=0;b<h;b+=1)y(b);this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=o("iframe","").hide(),i=e.el;window.document.body.appendChild(i);var n=i.contentWindow,r=n.document,a=document.createElement("style");a.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),r.head.appendChild(a),this.canvases.forEach((function(t){var e=t.cloneNode(!1),i=e.getContext("2d");i.drawImage(t,0,0),r.body.appendChild(e)})),n.print()}}]),t}(),ti=[{key:"copy",title:$("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:$("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:$("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:$("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:$("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:$("contextmenu.insertRow")},{key:"insert-column",title:$("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:$("contextmenu.deleteRow")},{key:"delete-column",title:$("contextmenu.deleteColumn")},{key:"delete-cell-text",title:$("contextmenu.deleteCellText")},{key:"hide",title:$("contextmenu.hide")},{key:"divider"},{key:"validation",title:$("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:$("contextmenu.cellprintable")},{key:"cell-non-printable",title:$("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:$("contextmenu.celleditable")},{key:"cell-non-editable",title:$("contextmenu.cellnoneditable")}];function ei(t){var e=this;return"divider"===t.key?o("div","".concat(wt,"-item divider")):o("div","".concat(wt,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),o("div","label").child(t.label||""))}function ii(){var t=this;return ti.map((function(e){return ei.call(t,e)}))}var ni=function(){function t(e){var i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(a["default"])(this,t),this.menuItems=ii.call(this),this.el=(i=o("div","".concat(wt,"-contextmenu"))).children.apply(i,Object(h["a"])(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=n,this.setMode("range")}return Object(l["default"])(t,[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),vt(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var i=this.el,n=i.show().offset(),r=n.width,a=this.viewFn(),l=a.height/2,s=t;a.width-t<=r&&(s-=r),i.css("left","".concat(s,"px")),e>l?i.css("bottom","".concat(a.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):i.css("top","".concat(e,"px")).css("max-height","".concat(a.height-e,"px")).css("bottom","auto"),gt(i)}}}]),t}(),ri=i("ReuC"),ai=i("foSv");function li(t,e){if(!e.classList.contains("active")){var i=e.getBoundingClientRect(),n=i.left,r=i.top,a=i.width,l=i.height,s=o("div","".concat(wt,"-tooltip")).html(t).show();document.body.appendChild(s.el);var c=s.box();s.css("left","".concat(n+a/2-c.width/2,"px")).css("top","".concat(r+l+2,"px")),ft(e,"mouseleave",(function(){document.body.contains(s.el)&&document.body.removeChild(s.el)})),ft(e,"click",(function(){document.body.contains(s.el)&&document.body.removeChild(s.el)}))}}var si=function(){function t(e,i,n){Object(a["default"])(this,t),this.tip=Y("toolbar.".concat(e.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()})))),i&&(this.tip+=" (".concat(i,")")),this.tag=e,this.shortcut=i,this.value=n,this.el=this.element(),this.change=function(){}}return Object(l["default"])(t,[{key:"element",value:function(){var t=this.tip;return o("div","".concat(wt,"-toolbar-btn")).on("mouseenter",(function(e){li(t,e.target)})).attr("data-tooltip",t)}},{key:"setState",value:function(){}}]),t}(),ci=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.apply(this,arguments)}return Object(l["default"])(i,[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,e=this.tag;return this.dd=this.dropdown(),this.dd.change=function(i){return t.change(e,t.getValue(i))},Object(ri["a"])(Object(ai["a"])(i.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}]),i}(si),oi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t,n,r,l){var s,c;Object(a["default"])(this,i),c=e.call(this,"div","".concat(wt,"-dropdown ").concat(l)),c.title=t,c.change=function(){},c.headerClick=function(){},"string"===typeof t?c.title=o("div","".concat(wt,"-dropdown-title")).child(t):r&&c.title.addClass("arrow-left"),c.contentEl=o("div","".concat(wt,"-dropdown-content")).css("width",n).hide();for(var h=arguments.length,u=new Array(h>4?h-4:0),f=4;f<h;f++)u[f-4]=arguments[f];return(s=c).setContentChildren.apply(s,u),c.headerEl=o("div","".concat(wt,"-dropdown-header")),c.headerEl.on("click",(function(){"block"!==c.contentEl.css("display")?c.show():c.hide()})).children(c.title,r?o("div","".concat(wt,"-icon arrow-right")).child(o("div","".concat(wt,"-icon-img arrow-down"))):""),c.children(c.headerEl,c.contentEl),c}return Object(l["default"])(i,[{key:"setContentChildren",value:function(){var t;(this.contentEl.html(""),arguments.length>0)&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this,e=this.contentEl;e.show(),this.parent().active(),gt(this.parent(),(function(){t.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),vt(this.parent())}}]),i}(c);function hi(t){return o("div","".concat(wt,"-item")).child(new $t(t))}var ui=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t,n){var r;Object(a["default"])(this,i);var l=new $t("align-".concat(n)),s=t.map((function(t){return hi("align-".concat(t)).on("click",(function(){r.setTitle(t),r.change(t)}))}));return r=e.call.apply(e,[this,l,"auto",!0,"bottom-left"].concat(Object(h["a"])(s)))}return Object(l["default"])(i,[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}]),i}(oi),fi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t){return Object(a["default"])(this,i),e.call(this,"align","",t)}return Object(l["default"])(i,[{key:"dropdown",value:function(){var t=this.value;return new ui(["left","center","right"],t)}}]),i}(ci),di=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t){return Object(a["default"])(this,i),e.call(this,"valign","",t)}return Object(l["default"])(i,[{key:"dropdown",value:function(){var t=this.value;return new ui(["top","middle","bottom"],t)}}]),i}(ci),vi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.apply(this,arguments)}return Object(l["default"])(i,[{key:"element",value:function(){var t=this,e=this.tag;return Object(ri["a"])(Object(ai["a"])(i.prototype),"element",this).call(this).child(new $t(e)).on("click",(function(){return t.click()}))}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}]),i}(si),gi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"autofilter")}return Object(l["default"])(i,[{key:"setState",value:function(){}}]),i}(vi),pi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"font-bold","Ctrl+B")}return i}(vi),yi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"font-italic","Ctrl+I")}return i}(vi),bi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"strike","Ctrl+U")}return i}(vi),mi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"underline","Ctrl+U")}return i}(vi),wi=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],ki=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],Oi=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function xi(t){var e=this;return o("td","").child(o("div","".concat(wt,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var ji=function t(){var e,i,n,r=this;Object(a["default"])(this,t),this.el=o("div","".concat(wt,"-color-palette")),this.change=function(){};var l=o("table","").children((e=o("tbody","")).children.apply(e,[(i=o("tr","".concat(wt,"-theme-color-placeholders"))).children.apply(i,Object(h["a"])(wi.map((function(t){return xi.call(r,t)}))))].concat(Object(h["a"])(ki.map((function(t){var e;return(e=o("tr","".concat(wt,"-theme-colors"))).children.apply(e,Object(h["a"])(t.map((function(t){return xi.call(r,t)}))))}))),[(n=o("tr","".concat(wt,"-standard-colors"))).children.apply(n,Object(h["a"])(Oi.map((function(t){return xi.call(r,t)}))))])));this.el.child(l)},Ci=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t,n){var r;Object(a["default"])(this,i);var l=new $t(t).css("height","16px").css("border-bottom","3px solid ".concat(n)),s=new ji;return s.change=function(t){r.setTitle(t),r.change(t)},r=e.call(this,l,"auto",!1,"bottom-left",s.el)}return Object(l["default"])(i,[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}]),i}(oi),Ei=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],Si=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t){var n;Object(a["default"])(this,i);var r=new $t("line-type"),l=0,s=Ei.map((function(e,i){return o("div","".concat(wt,"-item state ").concat(t===e[0]?"checked":"")).on("click",(function(){s[l].toggle("checked"),s[i].toggle("checked"),l=i,n.hide(),n.change(e)})).child(o("div","".concat(wt,"-line-type")).html(e[1]))}));return n=e.call.apply(e,[this,r,"auto",!1,"bottom-left"].concat(Object(h["a"])(s)))}return i}(oi);function Di(){var t;return o("table","").child((t=o("tbody","")).children.apply(t,arguments))}function Ti(t){var e=this;return o("td","").child(o("div","".concat(wt,"-border-palette-cell")).child(new $t("border-".concat(t))).on("click",(function(){e.mode=t;var i=e.mode,n=e.style,r=e.color;e.change({mode:i,style:n,color:r})})))}var Ai=function t(){var e,i,r=this;Object(a["default"])(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new Ci("line-color",this.color),this.ddColor.change=function(t){r.color=t},this.ddType=new Si(this.style),this.ddType.change=function(t){var e=Object(n["a"])(t,1),i=e[0];r.style=i},this.el=o("div","".concat(wt,"-border-palette"));var l=Di(o("tr","").children(o("td","".concat(wt,"-border-palette-left")).child(Di((e=o("tr","")).children.apply(e,Object(h["a"])(["all","inside","horizontal","vertical","outside"].map((function(t){return Ti.call(r,t)})))),(i=o("tr","")).children.apply(i,Object(h["a"])(["left","top","right","bottom","none"].map((function(t){return Ti.call(r,t)})))))),o("td","".concat(wt,"-border-palette-right")).children(o("div","".concat(wt,"-toolbar-btn")).child(this.ddColor.el),o("div","".concat(wt,"-toolbar-btn")).child(this.ddType.el))));this.el.child(l)},Ri=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){var t;Object(a["default"])(this,i);var n=new $t("border-all"),r=new Ai;return r.change=function(e){t.change(e),t.hide()},t=e.call(this,n,"auto",!1,"bottom-left",r.el)}return i}(oi),zi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"border")}return Object(l["default"])(i,[{key:"dropdown",value:function(){return new Ri}}]),i}(ci),Ii=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.apply(this,arguments)}return Object(l["default"])(i,[{key:"element",value:function(){var t=this;return Object(ri["a"])(Object(ai["a"])(i.prototype),"element",this).call(this).child(new $t(this.tag)).on("click",(function(){return t.change(t.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}]),i}(si),Hi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"clearformat")}return i}(Ii),Mi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"paintformat")}return Object(l["default"])(i,[{key:"setState",value:function(){}}]),i}(vi),Ni=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t){return Object(a["default"])(this,i),e.call(this,"color",void 0,t)}return Object(l["default"])(i,[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Ci(t,e)}}]),i}(ci),Fi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t){return Object(a["default"])(this,i),e.call(this,"bgcolor",void 0,t)}return Object(l["default"])(i,[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Ci(t,e)}}]),i}(ci),Wi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){var t;Object(a["default"])(this,i);var n=be.map((function(e){return o("div","".concat(wt,"-item")).on("click",(function(){t.setTitle("".concat(e.pt)),t.change(e)})).child("".concat(e.pt))}));return t=e.call.apply(e,[this,"10","60px",!0,"bottom-left"].concat(Object(h["a"])(n)))}return i}(oi),Vi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"font-size")}return Object(l["default"])(i,[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Wi}}]),i}(ci),_i=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){var t;Object(a["default"])(this,i);var n=ye.map((function(e){return o("div","".concat(wt,"-item")).on("click",(function(){t.setTitle(e.title),t.change(e)})).child(e.title)}));return t=e.call.apply(e,[this,ye[0].title,"160px",!0,"bottom-left"].concat(Object(h["a"])(n)))}return i}(oi),Pi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"font-name")}return Object(l["default"])(i,[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new _i}}]),i}(ci),qi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){var t;Object(a["default"])(this,i);var n=Ae.slice(0);return n.splice(2,0,{key:"divider"}),n.splice(8,0,{key:"divider"}),n=n.map((function(e){var i=o("div","".concat(wt,"-item"));return"divider"===e.key?i.addClass("divider"):(i.child(e.title()).on("click",(function(){t.setTitle(e.title()),t.change(e)})),e.label&&i.child(o("div","label").html(e.label))),i})),t=e.call.apply(e,[this,"Normal","220px",!0,"bottom-left"].concat(Object(h["a"])(n)))}return Object(l["default"])(i,[{key:"setTitle",value:function(t){for(var e=0;e<Ae.length;e+=1)Ae[e].key===t&&this.title.html(Ae[e].title());this.hide()}}]),i}(oi),Bi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"format")}return Object(l["default"])(i,[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new qi}}]),i}(ci),Li=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){var t;Object(a["default"])(this,i);var n=Ce.map((function(e){return o("div","".concat(wt,"-item")).on("click",(function(){t.hide(),t.change(e)})).child(e.key)}));return t=e.call.apply(e,[this,new $t("formula"),"180px",!0,"bottom-left"].concat(Object(h["a"])(n)))}return i}(oi),Ui=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"formula")}return Object(l["default"])(i,[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Li}}]),i}(ci),Yi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"freeze")}return i}(vi),$i=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"merge")}return Object(l["default"])(i,[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}]),i}(vi),Xi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"redo","Ctrl+Y")}return i}(Ii),Ji=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"undo","Ctrl+Z")}return i}(Ii),Ki=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"print","Ctrl+P")}return i}(Ii),Zi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){return Object(a["default"])(this,i),e.call(this,"textwrap")}return i}(vi),Gi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){var t;Object(a["default"])(this,i);var n=new $t("ellipsis"),r=o("div","".concat(wt,"-toolbar-more"));return t=e.call(this,n,"auto",!1,"bottom-right",r),t.moreBtns=r,t.contentEl.css("max-width","420px"),t}return i}(oi),Qi=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){var t;return Object(a["default"])(this,i),t=e.call(this,"more"),t.el.hide(),t}return Object(l["default"])(i,[{key:"dropdown",value:function(){return new Gi}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}]),i}(ci);function tn(){return o("div","".concat(wt,"-toolbar-divider"))}function en(){var t=this;this.btns2=[],this.items.forEach((function(e){if(Array.isArray(e))e.forEach((function(e){var i=e.el,n=i.box(),r=i.computedStyle(),a=r.marginLeft,l=r.marginRight;t.btns2.push([i,n.width+parseInt(a,10)+parseInt(l,10)])}));else{var i=e.box(),n=e.computedStyle(),r=n.marginLeft,a=n.marginRight;t.btns2.push([e,i.width+parseInt(r,10)+parseInt(a,10)])}}))}function nn(){var t,e,i=this.el,r=this.btns,a=this.moreEl,l=this.btns2,s=a.dd,c=s.moreBtns,o=s.contentEl;i.css("width","".concat(this.widthFn()-60,"px"));var h=i.box(),u=160,f=12,d=[],v=[];l.forEach((function(t,e){var i=Object(n["a"])(t,2),r=i[0],a=i[1];u+=a,e===l.length-1||u<h.width?d.push(r):(f+=a,v.push(r))})),(t=r.html("")).children.apply(t,d),(e=c.html("")).children.apply(e,v),o.css("width","".concat(f,"px")),v.length>0?a.show():a.hide()}var rn=function(){function t(e,i){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(a["default"])(this,t),this.data=e,this.change=function(){},this.widthFn=i,this.isHide=r;var l=e.defaultStyle();this.items=[[this.undoEl=new Ji,this.redoEl=new Xi,new Ki,this.paintformatEl=new Mi,this.clearformatEl=new Hi],tn(),[this.formatEl=new Bi],tn(),[this.fontEl=new Pi,this.fontSizeEl=new Vi],tn(),[this.boldEl=new pi,this.italicEl=new yi,this.underlineEl=new mi,this.strikeEl=new bi,this.textColorEl=new Ni(l.color)],tn(),[this.fillColorEl=new Fi(l.bgcolor),this.borderEl=new zi,this.mergeEl=new $i],tn(),[this.alignEl=new fi(l.align),this.valignEl=new di(l.valign),this.textwrapEl=new Zi],tn(),[this.freezeEl=new Yi,this.autofilterEl=new gi,this.formulaEl=new Ui,this.moreEl=new Qi]],this.el=o("div","".concat(wt,"-toolbar")),this.btns=o("div","".concat(wt,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){n.btns.child(t.el),t.change=function(){n.change.apply(n,arguments)}})):n.btns.child(t.el)})),this.el.child(this.btns),r?this.el.hide():(this.reset(),setTimeout((function(){en.call(n),nn.call(n)}),0),ft(window,"resize",(function(){nn.call(n)})))}return Object(l["default"])(t,[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var i=e.font,n=e.format;this.formatEl.setState(n),this.fontEl.setState(i.name),this.fontSizeEl.setState(i.size),this.boldEl.setState(i.bold),this.italicEl.setState(i.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}]),t}(),an=function(){function t(e,i){var n,r=this,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";Object(a["default"])(this,t),this.title=e,this.el=o("div","".concat(wt,"-modal")).css("width",l).children(o("div","".concat(wt,"-modal-header")).children(new $t("close").on("click.stop",(function(){return r.hide()})),this.title),(n=o("div","".concat(wt,"-modal-content"))).children.apply(n,Object(h["a"])(i))).hide()}return Object(l["default"])(t,[{key:"show",value:function(){var t=this;this.dimmer=o("div","".concat(wt,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),i=e.width,n=e.height,r=document.documentElement,a=r.clientHeight,l=r.clientWidth;this.el.offset({left:(l-i)/2,top:(a-n)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},ft(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),dt(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}]),t}(),ln=function(){function t(e,i){var n=this;Object(a["default"])(this,t),this.vchange=function(){},this.el=o("div","".concat(wt,"-form-input")),this.input=o("input","").css("width",e).on("input",(function(t){return n.vchange(t)})).attr("placeholder",i),this.el.child(this.input)}return Object(l["default"])(t,[{key:"focus",value:function(){var t=this;setTimeout((function(){t.input.el.focus()}),10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}]),t}(),sn=function(){function t(e,i,n){var r=this,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};Object(a["default"])(this,t),this.key=e,this.getTitle=l,this.vchange=function(){},this.el=o("div","".concat(wt,"-form-select")),this.suggest=new Lt(i.map((function(t){return{key:t,title:r.getTitle(t)}})),(function(t){r.itemClick(t.key),s(t.key),r.vchange(t.key)}),n,this.el),this.el.children(this.itemEl=o("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(function(){return r.show()}))}return Object(l["default"])(t,[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}]),t}(),cn={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},on=function(){function t(e,i,n,r){var l=this;Object(a["default"])(this,t),this.label="",this.rule=i,n&&(this.label=o("label","label").css("width","".concat(r,"px")).html(n)),this.tip=o("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return l.validate()},this.el=o("div","".concat(wt,"-form-field")).children(this.label,e.el,this.tip)}return Object(l["default"])(t,[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,i=this.tip,n=this.el,r=t.val();if(e.required&&/^\s*$/.test(r))return i.html(Y("validation.required")),n.addClass("error"),!1;if(e.type||e.pattern){var a=e.pattern||cn[e.type];if(!a.test(r))return i.html(Y("validation.notMatch")),n.addClass("error"),!1}return n.removeClass("error"),!0}}]),t}(),hn=100,un=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(){var t;Object(a["default"])(this,i);var n=new on(new sn("cell",["cell"],"100%",(function(t){return Y("dataValidation.modeType.".concat(t))})),{required:!0},"".concat(Y("dataValidation.range"),":"),hn),r=new on(new ln("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),l=new on(new sn("list",["list","number","date","phone","email"],"100%",(function(t){return Y("dataValidation.type.".concat(t))}),(function(e){return t.criteriaSelected(e)})),{required:!0},"".concat(Y("dataValidation.criteria"),":"),hn),s=new on(new sn("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(t){return Y("dataValidation.operator.".concat(t))}),(function(e){return t.criteriaOperatorSelected(e)})),{required:!0}).hide(),c=new on(new ln("70px","10"),{required:!0}).hide(),h=new on(new ln("70px","100"),{required:!0,type:"number"}).hide(),u=new on(new ln("120px","a,b,c"),{required:!0}),f=new on(new ln("70px","10"),{required:!0,type:"number"}).hide();return t=e.call(this,Y("contextmenu.validation"),[o("div","".concat(wt,"-form-fields")).children(n.el,r.el),o("div","".concat(wt,"-form-fields")).children(l.el,s.el,c.el,h.el,f.el,u.el),o("div","".concat(wt,"-buttons")).children(new oe("cancel").on("click",(function(){return t.btnClick("cancel")})),new oe("remove").on("click",(function(){return t.btnClick("remove")})),new oe("save","primary").on("click",(function(){return t.btnClick("save")})))]),t.mf=n,t.rf=r,t.cf=l,t.of=s,t.minvf=c,t.maxvf=h,t.vf=f,t.svf=u,t.change=function(){},t}return Object(l["default"])(i,[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",i=this.vf;i.input.hint(e),i.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,i=this.minvf,n=this.maxvf,r=this.vf,a=this.svf;"date"===t||"number"===t?(e.show(),i.rule.type=t,n.rule.type=t,"date"===t?(i.hint("2018-11-12"),n.hint("2019-11-12")):(i.hint("10"),n.hint("100")),i.show(),n.show(),r.hide(),a.hide()):("list"===t?a.show():a.hide(),r.hide(),e.hide(),i.hide(),n.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,i=this.maxvf,n=this.vf;if("be"===t||"nbe"===t)e.show(),i.show(),n.hide();else{var r=this.cf.val();n.rule.type=r,"date"===r?n.hint("2018-11-12"):n.hint("10"),n.show(),e.hide(),i.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],i=0;i<e.length;i+=1){var n=this[e[i]];if(n.isShow()&&!n.validate())return}var r=this.mf.val(),a=this.rf.val(),l=this.cf.val(),s=this.of.val(),c=this.svf.val();"number"!==l&&"date"!==l||(c="be"===s||"nbe"===s?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",r,a,{type:l,operator:s,required:!1,value:c}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,i=this.rf,n=this.cf,r=this.of,a=this.svf,l=this.vf,s=this.minvf,c=this.maxvf,o=t.mode,h=t.ref,u=t.validator,f=u||{type:"list"},d=f.type,v=f.operator,g=f.value;e.val(o||"cell"),i.val(h),n.val(d),r.val(v),Array.isArray(g)?(s.val(g[0]),c.val(g[1])):(a.val(g||""),l.val(g||"")),this.criteriaSelected(d),this.criteriaOperatorSelected(v)}this.show()}}]),i}(an);function fn(t){return o("div","".concat(wt,"-item ").concat(t))}function dn(t){var e=this;return fn("state").child(Y("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function vn(t){var e=this,i=this.filterbEl,n=this.filterValues;i.html("");var r=Object.keys(t);r.forEach((function(r,a){var l=t[r],s=n.includes(r)?"checked":"";i.child(o("div","".concat(wt,"-item state ").concat(s)).on("click.stop",(function(){return e.filterClick(a,r)})).children(""===r?Y("filter.empty"):r,o("div","label").html("(".concat(l,")"))))}))}function gn(){var t=this.filterhEl,e=this.filterValues,i=this.values;t.html("".concat(e.length," / ").concat(i.length)),t.checked(e.length===i.length)}var pn=function(){function t(){var e=this;Object(a["default"])(this,t),this.filterbEl=o("div","".concat(wt,"-body")),this.filterhEl=o("div","".concat(wt,"-header state")).on("click.stop",(function(){return e.filterClick(0,"all")})),this.el=o("div","".concat(wt,"-sort-filter")).children(this.sortAscEl=dn.call(this,"asc"),this.sortDescEl=dn.call(this,"desc"),fn("divider"),o("div","".concat(wt,"-filter")).children(this.filterhEl,this.filterbEl),o("div","".concat(wt,"-buttons")).children(new oe("cancel").on("click",(function(){return e.btnClick("cancel")})),new oe("ok","primary").on("click",(function(){return e.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}return Object(l["default"])(t,[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,i=this.sort,n=this.filterValues;this.ok&&this.ok(e,i,"in",n)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,i=this.sortDescEl;e.checked("asc"===t),i.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var i=this.filterbEl,n=this.filterValues,r=this.values,a=i.children();if("all"===e)a.length===n.length?(this.filterValues=[],a.forEach((function(t){return o(t).checked(!1)}))):(this.filterValues=Array.from(r),a.forEach((function(t){return o(t).checked(!0)})));else{var l=o(a[t]).toggle("checked");l?n.push(e):n.splice(n.findIndex((function(t){return t===e})),1)}gn.call(this)}},{key:"set",value:function(t,e,i,n){this.ci=t;var r=this.sortAscEl,a=this.sortDescEl;null!==n?(this.sort=n.order,r.checked(n.asc()),a.checked(n.desc())):(this.sortDesc=null,r.checked(!1),a.checked(!1)),this.values=Object.keys(e),this.filterValues=i?Array.from(i.value):Object.keys(e),vn.call(this,e,i),gn.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var i=1;gt(this.el,(function(){i<=0&&e.hide(),i-=1}))}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),vt(this.el)}}]),t}();function yn(t,e){var i=o("div","".concat(wt,"-toast")),n=o("div","".concat(wt,"-dimmer active")),r=function(){document.body.removeChild(i.el),document.body.removeChild(n.el)};i.children(o("div","".concat(wt,"-toast-header")).children(new $t("close").on("click.stop",(function(){return r()})),t),o("div","".concat(wt,"-toast-content")).html(e)),document.body.appendChild(i.el),document.body.appendChild(n.el);var a=i.box(),l=a.width,s=a.height,c=document.documentElement,h=c.clientHeight,u=c.clientWidth;i.offset({left:(u-l)/2,top:(h-s)/3})}function bn(t,e){var i,n=this;return function(){for(var r=n,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];var c=l;i||(i=setTimeout((function(){i=null,t.apply(r,c)}),e))}}function mn(){var t=this.data,e=this.verticalScrollbar,i=this.horizontalScrollbar,n=t.getSelectedRect(),r=n.l,a=n.t,l=n.left,s=n.top,c=n.width,o=n.height,h=this.getTableOffset();if(Math.abs(l)+c>h.width)i.move({left:r+c-h.width});else{var u=t.freezeTotalWidth();l<u&&i.move({left:r-1-u})}if(Math.abs(s)+o>h.height)e.move({top:a+o-h.height-1});else{var f=t.freezeTotalHeight();s<f&&e.move({top:a-1-f})}}function wn(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==i){var a=this.table,l=this.selector,s=this.toolbar,c=this.data,o=this.contextMenu;o.setMode(-1===e||-1===i?"row-col":"range");var h=c.getCell(e,i);t?(l.setEnd(e,i,r),this.trigger("cells-selected",h,l.range)):(l.set(e,i,n),this.trigger("cell-selected",h,e,i)),s.reset(),a.render()}}function kn(t,e){var i=this.selector,r=this.data,a=r.rows,l=r.cols,s=Object(n["a"])(i.indexes,2),c=s[0],o=s[1],h=i.range,u=h.eri,f=h.eci;if(t){var d=Object(n["a"])(i.moveIndexes,2);c=d[0],o=d[1]}"left"===e?o>0&&(o-=1):"right"===e?(f!==o&&(o=f),o<l.len-1&&(o+=1)):"up"===e?c>0&&(c-=1):"down"===e?(u!==c&&(c=u),c<a.len-1&&(c+=1)):"row-first"===e?o=0:"row-last"===e?o=l.len-1:"col-first"===e?c=0:"col-last"===e&&(c=a.len-1),t&&(i.moveIndexes=[c,o]),wn.call(this,t,c,o),mn.call(this)}function On(t){if(0===t.buttons&&t.target.className!=="".concat(wt,"-resizer-hover")){var e=t.offsetX,i=t.offsetY,n=this.rowResizer,r=this.colResizer,a=this.tableEl,l=this.data,s=l.rows,c=l.cols;if(e>c.indexWidth&&i>s.height)return n.hide(),void r.hide();var o=a.box(),h=l.getCellRectByXY(t.offsetX,t.offsetY);h.ri>=0&&-1===h.ci?(h.width=c.indexWidth,n.show(h,{width:o.width}),s.isHide(h.ri-1)?n.showUnhide(h.ri):n.hideUnhide()):n.hide(),-1===h.ri&&h.ci>=0?(h.height=s.height,r.show(h,{height:o.height}),c.isHide(h.ci-1)?r.showUnhide(h.ci):r.hideUnhide()):r.hide()}}function xn(t){var e=this.verticalScrollbar,i=this.horizontalScrollbar,n=this.data,r=e.scroll(),a=r.top,l=i.scroll(),s=l.left,c=n.rows,o=n.cols,h=t.deltaY,u=t.deltaX,f=function(t,e){var i=t,n=0;do{n=e(i),i+=1}while(n<=0);return n},d=function(t){if(t>0){var i=n.scroll.ri+1;if(i<c.len){var r=f(i,(function(t){return c.getHeight(t)}));e.move({top:a+r-1})}}else{var l=n.scroll.ri-1;if(l>=0){var s=f(l,(function(t){return c.getHeight(t)}));e.move({top:0===l?0:a-s})}}},v=function(t){if(t>0){var e=n.scroll.ci+1;if(e<o.len){var r=f(e,(function(t){return o.getWidth(t)}));i.move({left:s+r-1})}}else{var a=n.scroll.ci-1;if(a>=0){var l=f(a,(function(t){return o.getWidth(t)}));i.move({left:0===a?0:s-l})}}},g=Math.abs(h),p=Math.abs(u),y=Math.max(g,p);/Firefox/i.test(window.navigator.userAgent)&&bn(d(t.detail),50),y===p&&bn(v(u),50),y===g&&bn(d(h),50)}function jn(t,e){var i=this.verticalScrollbar,n=this.horizontalScrollbar,r=i.scroll(),a=r.top,l=n.scroll(),s=l.left;"left"===t||"right"===t?n.move({left:s-e}):"up"!==t&&"down"!==t||i.move({top:a-e})}function Cn(){var t=this.data,e=this.verticalScrollbar,i=this.getTableOffset(),n=i.height,r=t.exceptRowTotalHeight(0,-1);e.set(n,t.rows.totalHeight()-r)}function En(){var t=this.data,e=this.horizontalScrollbar,i=this.getTableOffset(),n=i.width;t&&e.set(n,t.cols.totalWidth())}function Sn(){var t=this.selector,e=this.data,i=this.editor,r=Object(n["a"])(e.freeze,2),a=r[0],l=r[1];if(a>0||l>0){var s=e.freezeTotalWidth(),c=e.freezeTotalHeight();i.setFreezeLengths(s,c)}t.resetAreaOffset()}function Dn(){var t=this.tableEl,e=this.overlayerEl,i=this.overlayerCEl,n=this.table,r=this.toolbar,a=this.selector,l=this.el,s=this.getTableOffset(),c=this.getRect();t.attr(c),e.offset(c),i.offset(s),l.css("width","".concat(c.width,"px")),Cn.call(this),En.call(this),Sn.call(this),n.render(),r.reset(),a.reset()}function Tn(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function An(){var t=this.data,e=this.selector;t.copy(),t.copyToSystemClipboard(),e.showClipboard()}function Rn(){var t=this.data,e=this.selector;t.cut(),e.showClipboard()}function zn(t,e){var i=this.data;if("read"!==i.settings.mode)if(i.paste(t,(function(t){return yn("Tip",t)})))Dn.call(this);else if(e){var n=e.clipboardData.getData("text/plain");this.data.pasteFromText(n),Dn.call(this)}}function In(){this.data.hideRowsOrCols(),Dn.call(this)}function Hn(t,e){this.data.unhideRowsOrCols(t,e),Dn.call(this)}function Mn(){var t=this.data;t.autofilter(),Dn.call(this)}function Nn(){var t=this.toolbar;t.paintformatActive()&&(zn.call(this,"format"),Tn.call(this),t.paintformatToggle())}function Fn(t){var e=this,i=this.selector,n=this.data,r=this.table,a=this.sortFilter,l=t.offsetX,s=t.offsetY,c=t.target.className==="".concat(wt,"-selector-corner"),o=n.getCellRectByXY(l,s),h=o.left,u=o.top,f=o.width,d=o.height,v=o.ri,g=o.ci,p=n.autoFilter;if(p.includes(v,g)&&h+f-20<l&&u+d-20<s){var y=p.items(g,(function(t,e){return n.rows.getCell(t,e)}));return a.hide(),a.set(g,y,p.getFilter(g),p.getSort(g)),void a.setOffset({left:h,top:u+d+2})}t.shiftKey||(c?i.showAutofill(v,g):wn.call(this,!1,v,g),pt(window,(function(t){var r=n.getCellRectByXY(t.offsetX,t.offsetY);v=r.ri,g=r.ci,c?i.showAutofill(v,g):1!==t.buttons||t.shiftKey||wn.call(e,!0,v,g,!0,!0)}),(function(){c&&i.arange&&"read"!==n.settings.mode&&n.autofill(i.arange,"all",(function(t){return yn("Tip",t)}))&&r.render(),i.hideAutofill(),Nn.call(e)}))),c||1!==t.buttons||t.shiftKey&&wn.call(this,!0,v,g)}function Wn(){var t=this.editor,e=this.data,i=e.getSelectedRect(),n=this.getTableOffset(),r="top";i.top>n.height/2&&(r="bottom"),t.setOffset(i,r)}function Vn(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(Wn.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),Tn.call(this))}function _n(t){var e=this,i=this.data,n=this.table,r=this.selector;i.scrolly(t,(function(){r.resetBRLAreaOffset(),Wn.call(e),n.render()}))}function Pn(t){var e=this,i=this.data,n=this.table,r=this.selector;i.scrollx(t,(function(){r.resetBRTAreaOffset(),Wn.call(e),n.render()}))}function qn(t,e){var i=t.ri,n=this.table,r=this.selector,a=this.data;a.rows.setHeight(i,e),n.render(),r.resetAreaOffset(),Cn.call(this),Wn.call(this)}function Bn(t,e){var i=t.ci,n=this.table,r=this.selector,a=this.data;a.cols.setWidth(i,e),n.render(),r.resetAreaOffset(),En.call(this),Wn.call(this)}function Ln(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",i=this.data,n=this.table;if("read"!==i.settings.mode){i.setSelectedCellText(t,e);var r=i.selector,a=r.ri,l=r.ci;"finished"===e?n.render():this.trigger("cell-edited",t,a,l)}}function Un(t){var e=this.data;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e["delete"]("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e["delete"]("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),Tn.call(this),Dn.call(this))}function Yn(t,e){var i=this.data;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?An.call(this):Tn.call(this);else if("clearformat"===t)Un.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)Mn.call(this);else if("freeze"===t)if(e){var n=i.selector,r=n.ri,a=n.ci;this.freeze(r,a)}else this.freeze(0,0);else i.setSelectedCellAttr(t,e),"formula"!==t||i.selector.multiple()||Vn.call(this),Dn.call(this)}function $n(t,e,i,n){this.data.setAutoFilter(t,e,i,n),Dn.call(this)}function Xn(){var t=this,e=this.selector,i=this.overlayerEl,n=this.rowResizer,r=this.colResizer,a=this.verticalScrollbar,l=this.horizontalScrollbar,s=this.editor,c=this.contextMenu,o=this.toolbar,h=this.modalValidation,u=this.sortFilter;i.on("mousemove",(function(e){On.call(t,e)})).on("mousedown",(function(e){s.clear(),c.hide(),2===e.buttons?(t.data.xyInSelectedRect(e.offsetX,e.offsetY)||Fn.call(t,e),c.setPosition(e.offsetX,e.offsetY),e.stopPropagation()):2===e.detail?Vn.call(t):Fn.call(t,e)})).on("mousewheel.stop",(function(e){xn.call(t,e)})).on("mouseout",(function(t){var e=t.offsetX,i=t.offsetY;i<=0&&r.hide(),e<=0&&n.hide()})),e.inputChange=function(e){Ln.call(t,e,"input"),Vn.call(t)},bt(i.el,{move:function(e,i){jn.call(t,e,i)}}),o.change=function(e,i){return Yn.call(t,e,i)},u.ok=function(e,i,n,r){return $n.call(t,e,i,n,r)},n.finishedFn=function(e,i){qn.call(t,e,i)},r.finishedFn=function(e,i){Bn.call(t,e,i)},n.unhideFn=function(e){Hn.call(t,"row",e)},r.unhideFn=function(e){Hn.call(t,"col",e)},a.moveFn=function(e,i){_n.call(t,e,i)},l.moveFn=function(e,i){Pn.call(t,e,i)},s.change=function(e,i){Ln.call(t,i,e)},h.change=function(e){if("save"===e){for(var i,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];(i=t.data).addValidation.apply(i,r)}else t.data.removeValidation()},c.itemClick=function(e){"validation"===e?h.setValue(t.data.getSelectedValidation()):"copy"===e?An.call(t):"cut"===e?Rn.call(t):"paste"===e?zn.call(t,"all"):"paste-value"===e?zn.call(t,"text"):"paste-format"===e?zn.call(t,"format"):"hide"===e?In.call(t):Un.call(t,e)},ft(window,"resize",(function(){t.reload()})),ft(window,"click",(function(e){t.focusing=i.contains(e.target)})),ft(window,"paste",(function(e){t.focusing&&(zn.call(t,"all",e),e.preventDefault())})),ft(window,"keydown",(function(e){if(t.focusing){var i=e.keyCode||e.which,n=e.key,r=e.ctrlKey,a=e.shiftKey,l=e.metaKey;if(r||l)switch(i){case 90:t.undo(),e.preventDefault();break;case 89:t.redo(),e.preventDefault();break;case 67:An.call(t),e.preventDefault();break;case 88:Rn.call(t),e.preventDefault();break;case 85:o.trigger("underline"),e.preventDefault();break;case 86:break;case 37:kn.call(t,a,"row-first"),e.preventDefault();break;case 38:kn.call(t,a,"col-first"),e.preventDefault();break;case 39:kn.call(t,a,"row-last"),e.preventDefault();break;case 40:kn.call(t,a,"col-last"),e.preventDefault();break;case 32:wn.call(t,!1,-1,t.data.selector.ci,!1),e.preventDefault();break;case 66:o.trigger("bold");break;case 73:o.trigger("italic");break;default:break}else{switch(i){case 32:a&&wn.call(t,!1,t.data.selector.ri,-1,!1);break;case 27:c.hide(),Tn.call(t);break;case 37:kn.call(t,a,"left"),e.preventDefault();break;case 38:kn.call(t,a,"up"),e.preventDefault();break;case 39:kn.call(t,a,"right"),e.preventDefault();break;case 40:kn.call(t,a,"down"),e.preventDefault();break;case 9:s.clear(),kn.call(t,!1,a?"left":"right"),e.preventDefault();break;case 13:s.clear(),kn.call(t,!1,a?"up":"down"),e.preventDefault();break;case 8:Un.call(t,"delete-cell-text"),e.preventDefault();break;default:break}"Delete"===n?(Un.call(t,"delete-cell-text"),e.preventDefault()):i>=65&&i<=90||i>=48&&i<=57||i>=96&&i<=105||"="===e.key?(Ln.call(t,e.key,"input"),Vn.call(t)):113===i&&Vn.call(t)}}}))}var Jn=function(){function t(e,i){var n=this;Object(a["default"])(this,t),this.eventMap=mt();var r=i.settings,l=r.view,s=r.showToolbar,c=r.showContextmenu;this.el=o("div","".concat(wt,"-sheet")),this.toolbar=new rn(i,l.width,!s),this.print=new Qe(i),e.children(this.toolbar.el,this.el,this.print.el),this.data=i,this.tableEl=o("canvas","".concat(wt,"-table")),this.rowResizer=new kt(!1,i.rows.height),this.colResizer=new kt(!0,i.cols.minWidth),this.verticalScrollbar=new Ot(!0),this.horizontalScrollbar=new Ot(!1),this.editor=new ce(Ee,(function(){return n.getTableOffset()}),i.rows.height),this.modalValidation=new un,this.contextMenu=new ni((function(){return n.getRect()}),!c),this.selector=new Vt(i),this.overlayerCEl=o("div","".concat(wt,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=o("div","".concat(wt,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new pn,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new Ye(this.tableEl.el,i),Xn.call(this),Dn.call(this),wn.call(this,!1,0,0)}return Object(l["default"])(t,[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];e.fire(t,n)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,Cn.call(this),En.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),Dn.call(this),this}},{key:"freeze",value:function(t,e){var i=this.data;return i.setFreeze(t,e),Dn.call(this),this}},{key:"undo",value:function(){this.data.undo(),Dn.call(this)}},{key:"redo",value:function(){this.data.redo(),Dn.call(this)}},{key:"reload",value:function(){return Dn.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,i=t.cols,n=this.getRect(),r=n.width,a=n.height;return{width:r-i.indexWidth,height:a-e.height,left:i.indexWidth,top:e.height}}}]),t}(),Kn=function(t){Object(Ut["default"])(i,t);var e=Object(Yt["default"])(i);function i(t){var n;Object(a["default"])(this,i);var r=new $t("ellipsis");return n=e.call(this,r,"auto",!1,"top-left"),n.contentClick=t,n}return Object(l["default"])(i,[{key:"reset",value:function(t){var e=this,i=t.map((function(t,i){return o("div","".concat(wt,"-item")).css("width","150px").css("font-weight","normal").on("click",(function(){e.contentClick(i),e.hide()})).child(t)}));this.setContentChildren.apply(this,Object(h["a"])(i))}},{key:"setTitle",value:function(){}}]),i}(oi),Zn=[{key:"delete",title:$("contextmenu.deleteSheet")}];function Gn(t){var e=this;return o("div","".concat(wt,"-item")).child(t.title()).on("click",(function(){e.itemClick(t.key),e.hide()}))}function Qn(){var t=this;return Zn.map((function(e){return Gn.call(t,e)}))}var tr=function(){function t(){var e;Object(a["default"])(this,t),this.el=(e=o("div","".concat(wt,"-contextmenu")).css("width","160px")).children.apply(e,Object(h["a"])(Qn.call(this))).hide(),this.itemClick=function(){}}return Object(l["default"])(t,[{key:"hide",value:function(){var t=this.el;t.hide(),vt(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),gt(e)}}]),t}(),er=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};Object(a["default"])(this,t),this.swapFunc=n,this.updateFunc=l,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new Kn((function(t){e.clickSwap2(e.items[t])})),this.contextMenu=new tr,this.contextMenu.itemClick=r,this.el=o("div","".concat(wt,"-bottombar")).children(this.contextMenu.el,this.menuEl=o("ul","".concat(wt,"-menu")).child(o("li","").children(new $t("add").on("click",(function(){i()})),o("span","").child(this.moreEl))))}return Object(l["default"])(t,[{key:"addItem",value:function(t,e){var i=this;this.dataNames.push(t);var n=o("li",e?"active":"").child(t);n.on("click",(function(){i.clickSwap2(n)})).on("contextmenu",(function(t){var e=t.target,r=e.offsetLeft,a=e.offsetHeight;i.contextMenu.setOffset({left:r,bottom:a+1}),i.deleteEl=n})).on("dblclick",(function(){var t=n.html(),e=new ln("auto","");e.val(t),e.input.on("blur",(function(e){var n=e.target,r=n.value,a=i.dataNames.findIndex((function(e){return e===t}));i.renameItem(a,r)})),n.html("").child(e.el),e.focus()})),e&&this.clickSwap(n),this.items.push(n),this.menuEl.child(n),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach((function(e){t.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var i=this.items.findIndex((function(t){return t===e}));if(this.items.splice(i,1),this.dataNames.splice(i,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var r=Object(n["a"])(this.items,1),a=r[0];return this.activeEl=a,this.activeEl.toggle(),[i,0]}return[i,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex((function(e){return e===t}));this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}]),t}(),ir=(i("Di0D"),function(){function t(e){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(a["default"])(this,t);var l=e;this.options=Object(r["a"])({showBottomBar:!0},n),this.sheetIndex=1,this.datas=[],"string"===typeof e&&(l=document.querySelector(e)),this.bottombar=this.options.showBottomBar?new er((function(){var t=i.addSheet();i.sheet.resetData(t)}),(function(t){var e=i.datas[t];i.sheet.resetData(e)}),(function(){i.deleteSheet()}),(function(t,e){i.datas[t].name=e})):null,this.data=this.addSheet();var s=o("div","".concat(wt)).on("contextmenu",(function(t){return t.preventDefault()}));l.appendChild(s.el),this.sheet=new Jn(s,this.data),null!==this.bottombar&&s.child(this.bottombar.el)}return Object(l["default"])(t,[{key:"addSheet",value:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t||"sheet".concat(this.sheetIndex),r=new ut(n,this.options);return r.change=function(){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];(t=e.sheet).trigger.apply(t,["change"].concat(n))},this.datas.push(r),null!==this.bottombar&&this.bottombar.addItem(n,i),this.sheetIndex+=1,r}},{key:"deleteSheet",value:function(){if(null!==this.bottombar){var t=this.bottombar.deleteItem(),e=Object(n["a"])(t,2),i=e[0],r=e[1];i>=0&&(this.datas.splice(i,1),r>=0&&this.sheet.resetData(this.datas[r]))}}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],e.length>0)for(var i=0;i<e.length;i+=1){var n=e[i],r=this.addSheet(n.name,0===i);r.setData(n),0===i&&this.sheet.resetData(r)}return this}},{key:"getData",value:function(){return this.datas.map((function(t){return t.getData()}))}},{key:"cellText",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[n].setCellText(t,e,i,"finished"),this}},{key:"cell",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[i].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[i].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){var t=this.data.validations;return t.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}],[{key:"locale",value:function(t,e){X(t,e)}}]),t}()),nr=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new ir(t,e)};window&&(window.x_spreadsheet=nr,window.x_spreadsheet.locale=function(t,e){return X(t,e)});e["default"]=ir}}]);